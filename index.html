<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sport Tracker</title>
    <meta name="theme-color" content="#007AFF">
    <meta name="description" content="–¢—Ä–µ–∫–µ—Ä —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞">
    <meta name="mobile-web-app-capable" content="yes">
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Sport Tracker">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            line-height: 1.6;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
        }
        
        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .nav {
            display: flex;
            background: #007AFF;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .nav-button {
            flex: 1;
            padding: 15px;
            background: none;
            border: none;
            color: white;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .nav-button.active {
            background: rgba(255,255,255,0.2);
        }
        
        .nav-button:hover {
            background: rgba(255,255,255,0.1);
        }
        
        /* –ö–æ–Ω—Ç–µ–Ω—Ç */
        .content {
            padding: 20px;
            display: none;
        }
        
        .content.active {
            display: block;
        }
        
        .title {
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
            color: #333;
        }
        
        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-top: 20px;
            margin-bottom: 10px;
            color: #333;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π */
        .exercise-with-animation {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
        }
        
        .exercise-name {
            flex: 1;
        }
        
        .exercise-animation {
            width: 40px;
            height: 40px;
            margin-left: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –≥—Ä—É–ø–ø –º—ã—à—Ü */
        .animation-chest {
            animation: chest-press 2s infinite ease-in-out;
        }
        
        .animation-back {
            animation: pull-up 2s infinite ease-in-out;
        }
        
        .animation-arms {
            animation: bicep-curl 2s infinite ease-in-out;
        }
        
        .animation-shoulders {
            animation: shoulder-press 2s infinite ease-in-out;
        }
        
        .animation-legs {
            animation: squat 2s infinite ease-in-out;
        }
        
        .animation-cardio {
            animation: running 1s infinite linear;
        }
        
        .animation-abs {
            animation: crunch 2s infinite ease-in-out;
        }
        
        @keyframes chest-press {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1) translateX(-2px); }
        }
        
        @keyframes pull-up {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-3px); }
        }
        
        @keyframes bicep-curl {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(-15deg); }
        }
        
        @keyframes shoulder-press {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-2px); }
        }
        
        @keyframes squat {
            0%, 100% { transform: translateY(0px) scale(1); }
            50% { transform: translateY(2px) scale(0.95); }
        }
        
        @keyframes running {
            0%, 100% { transform: translateX(0px); }
            25% { transform: translateX(2px) translateY(-1px); }
            75% { transform: translateX(-2px) translateY(1px); }
        }
        
        @keyframes crunch {
            0%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(0.9); }
        }

        /* –ß–µ–∫–±–æ–∫—Å—ã –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ */
        .grip-options {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }
        
        .grip-option {
            flex: 1;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: #f9f9f9;
            cursor: pointer;
            text-align: center;
            font-size: 12px;
        }
        
        .grip-option.selected {
            background: #007AFF;
            color: white;
            border-color: #007AFF;
        }

        /* –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π */
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .edit-button, .delete-button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .edit-button {
            background: #FF9500;
            color: white;
        }
        
        .delete-button {
            background: #FF3B30;
            color: white;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .workout-details {
            margin: 15px 0;
        }
        
        .workout-set {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .workout-set:last-child {
            border-bottom: none;
        }
        
        .close-modal {
            background: #007AFF;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            width: 100%;
            margin-top: 15px;
        }

        /* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –ø—Ä–µ–∂–Ω–∏–º–∏ */
        .calendar {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .calendar-nav {
            background: #007AFF;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
        }
        
        .calendar-month {
            font-size: 18px;
            font-weight: 600;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }
        
        .calendar-day {
            text-align: center;
            font-size: 12px;
            color: #666;
            padding: 5px;
        }
        
        .calendar-date {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .calendar-date.has-workout {
            background: #34C759;
            color: white;
            font-weight: bold;
        }
        
        .calendar-date.today {
            border: 2px solid #007AFF;
        }
        
        .calendar-date.other-month {
            color: #ccc;
        }
        
        .workout-history {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
        }
        
        .history-item {
            padding: 12px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
        }
        
        .history-item:last-child {
            border-bottom: none;
        }
        
        .history-exercise {
            font-weight: 500;
            margin-bottom: 5px;
        }
        
        .history-details {
            font-size: 12px;
            color: #666;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #007AFF;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 12px;
            color: #666;
        }
        
        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ */
        .groups-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .group-button {
            background: #e0e0e0;
            padding: 15px;
            border-radius: 10px;
            border: none;
            flex: 1 1 calc(50% - 10px);
            min-width: 140px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .group-button:hover {
            background: #d0d0d0;
        }
        
        .group-button.selected {
            background: #007AFF;
            color: white;
        }
        
        .group-button-text {
            font-size: 16px;
            font-weight: 500;
            text-align: center;
        }
        
        .exercises-container {
            margin-bottom: 20px;
        }
        
        .exercise-button {
            background: #f0f0f0;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #ddd;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
        }
        
        .exercise-button:hover {
            background: #e8e8e8;
        }
        
        .exercise-button.selected {
            background: #007AFF;
            color: white;
            border-color: #007AFF;
        }
        
        .set-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid #eee;
            gap: 10px;
        }
        
        .set-number {
            font-size: 16px;
            font-weight: 500;
            min-width: 80px;
        }
        
        .set-inputs {
            display: flex;
            gap: 10px;
            flex: 1;
        }
        
        .weight-input, .reps-input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            width: 100%;
        }
        
        .weight-input:focus, .reps-input:focus {
            outline: none;
            border-color: #007AFF;
        }
        
        .input-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 4px;
        }
        
        .input-group {
            flex: 1;
        }
        
        .checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid #007AFF;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            flex-shrink: 0;
        }
        
        .checkbox.completed {
            background: #007AFF;
        }
        
        .checkbox-text {
            color: white;
            font-weight: bold;
        }
        
        .add-button, .save-button {
            padding: 15px;
            border-radius: 8px;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-bottom: 10px;
            transition: opacity 0.3s;
        }
        
        .add-button {
            background: #34C759;
            color: white;
        }
        
        .save-button {
            background: #007AFF;
            color: white;
        }
        
        .add-button:hover, .save-button:hover {
            opacity: 0.9;
        }
        
        .completed-set {
            background: #f8fff8;
            border-color: #34C759;
        }

        .quick-start {
            background: #34C759;
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-top: 20px;
            cursor: pointer;
            font-weight: 600;
        }

        /* Install Prompt */
        .install-prompt {
            background: #007AFF;
            color: white;
            padding: 12px 15px;
            border-radius: 10px;
            margin: 10px 0;
            display: none;
            align-items: center;
            justify-content: space-between;
        }
        
        .install-text {
            flex: 1;
            font-size: 14px;
        }
        
        .install-close {
            background: none;
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- PWA Install Prompt -->
        <div class="install-prompt" id="installPrompt">
            <div class="install-text">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ?</div>
            <button class="install-close" onclick="hideInstallPrompt()">√ó</button>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ -->
        <div class="modal" id="workoutModal">
            <div class="modal-content">
                <div class="modal-title" id="modalExerciseName"></div>
                <div class="workout-details" id="workoutDetails">
                    <!-- –î–µ—Ç–∞–ª–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ -->
                </div>
                <button class="close-modal" onclick="closeWorkoutModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <div class="nav">
            <button class="nav-button active" onclick="showTab('home')">üè† –ì–ª–∞–≤–Ω–∞—è</button>
            <button class="nav-button" onclick="showTab('workout')">üí™ –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</button>
            <button class="nav-button" onclick="showTab('analytics')">üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</button>
        </div>

        <!-- –ì–ª–∞–≤–Ω–∞—è - –ö–∞–ª–µ–Ω–¥–∞—Ä—å -->
        <div id="home" class="content active">
            <div class="title">–ú–æ–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</div>
            
            <div class="calendar">
                <div class="calendar-header">
                    <button class="calendar-nav" onclick="changeMonth(-1)">‚Üê</button>
                    <div class="calendar-month" id="currentMonth"></div>
                    <button class="calendar-nav" onclick="changeMonth(1)">‚Üí</button>
                </div>
                <div class="calendar-grid" id="calendarGrid">
                    <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ JS -->
                </div>
            </div>

            <div class="workout-history" id="workoutHistory">
                <!-- –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ -->
            </div>

            <div class="quick-start" onclick="showTab('workout')">
                + –ù–∞—á–∞—Ç—å –Ω–æ–≤—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
            </div>
        </div>

        <!-- –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ -->
        <div id="workout" class="content">
            <div class="title">–ù–æ–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</div>
            
            <div class="section-title">1. –í—ã–±–µ—Ä–∏—Ç–µ –≥—Ä—É–ø–ø—É –º—ã—à—Ü:</div>
            <div class="groups-container" id="groupsContainer"></div>
            
            <div id="exercisesSection" style="display: none;">
                <div class="section-title" id="exercisesTitle">2. –í—ã–±–µ—Ä–∏—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ:</div>
                <div class="exercises-container" id="exercisesContainer"></div>
            </div>
            
            <div id="setsSection" style="display: none;">
                <div class="section-title" id="setsTitle">3. –ü–æ–¥—Ö–æ–¥—ã –¥–ª—è: <span id="selectedExerciseName"></span></div>
                
                <!-- –ß–µ–∫–±–æ–∫—Å—ã –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–ª—è –∂–∏–º–æ–≤ –∏ –ø—Ä–∏—Å–µ–¥–∞–Ω–∏–π -->
                <div id="gripSection" style="display: none;">
                    <div class="section-title">–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞:</div>
                    <div class="grip-options">
                        <div class="grip-option" onclick="selectGrip('narrow')">–£–∑–∫–∞—è</div>
                        <div class="grip-option" onclick="selectGrip('medium')">–°—Ä–µ–¥–Ω—è—è</div>
                        <div class="grip-option" onclick="selectGrip('wide')">–®–∏—Ä–æ–∫–∞—è</div>
                    </div>
                </div>
                
                <div id="setsContainer"></div>
                
                <button class="add-button" id="addSetButton">+ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Ö–æ–¥</button>
                <button class="save-button" id="saveButton">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É</button>
            </div>
        </div>

        <!-- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ -->
        <div id="analytics" class="content">
            <div class="title">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalWorkouts">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="monthWorkouts">0</div>
                    <div class="stat-label">–ó–∞ —ç—Ç–æ—Ç –º–µ—Å—è—Ü</div>
                </div>
            </div>

            <div class="chart-container">
                <canvas id="muscleGroupChart"></canvas>
            </div>

            <div class="chart-container">
                <canvas id="progressChart"></canvas>
            </div>  
        </div>
    </div>
        <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö -->
    <script src="database.js"></script>

    <script>
        // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π
        const exercisesDatabase = {
            "–ì—Ä—É–¥—å": [
                "–ñ–∏–º —à—Ç–∞–Ω–≥–∏ –Ω–∞ –ø—Ä—è–º–æ–π —Å–∫–∞–º—å–µ", "–ñ–∏–º —à—Ç–∞–Ω–≥–∏ –ø–æ–¥ —É–≥–ª–æ–º", "–ñ–∏–º —à—Ç–∞–Ω–≥–∏ –ø–æ–¥ –Ω–∞–∫–ª–æ–Ω–æ–º –≤–Ω–∏–∑",
                "–ñ–∏–º —à—Ç–∞–Ω–≥–∏ –≤ —Å–º–∏—Ç–µ –Ω–∞ –ø—Ä—è–º–æ–π —Å–∫–∞–º—å–µ", "–ñ–∏–º —à—Ç–∞–Ω–≥–∏ –≤ —Å–º–∏—Ç–µ –ø–æ–¥ —É–≥–ª–æ–º",
                "–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –Ω–∞ –ø—Ä—è–º–æ–π —Å–∫–∞–º—å–µ", "–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ø–æ–¥ —É–≥–ª–æ–º", "–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ø–æ–¥ –Ω–∞–∫–ª–æ–Ω–æ–º –≤–Ω–∏–∑", 
                "–†–∞–∑–≤–æ–¥–∫–∞ –≥–∞–Ω—Ç–µ–ª–µ–π –Ω–∞ –ø—Ä—è–º–æ–π —Å–∫–∞–º—å–µ", "–†–∞–∑–≤–æ–¥–∫–∞ –≥–∞–Ω—Ç–µ–ª–µ–π –ø–æ–¥ —É–≥–ª–æ–º",
                "–°–≤–µ–¥–µ–Ω–∏–µ –≤ —Ç—Ä–µ–Ω–∞–∂–µ—Ä–µ", "–°–≤–µ–¥–µ–Ω–∏–µ –≤ –∫—Ä–æ—Å–æ–≤–µ—Ä–µ"
            ],
            "–°–ø–∏–Ω–∞": [
                "–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è", "–¢—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ", "–¢—è–≥–∞ –≥–∞–Ω—Ç–µ–ª–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ",
                "–¢—è–≥–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ –±–ª–æ–∫–∞", "–¢—è–≥–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –±–ª–æ–∫–∞", "–ì–∏–ø–µ—Ä—ç–∫—Å—Ç–µ–Ω–∑–∏—è"
            ],
            "–†—É–∫–∏": [
                "–ü–æ–¥—ä–µ–º —à—Ç–∞–Ω–≥–∏ –Ω–∞ –±–∏—Ü–µ–ø—Å", "–ü–æ–¥—ä–µ–º –≥–∞–Ω—Ç–µ–ª–µ–π –Ω–∞ –±–∏—Ü–µ–ø—Å", "–ú–æ–ª–æ—Ç–∫–∏",
                "–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π –∂–∏–º", "–†–∞–∑–≥–∏–±–∞–Ω–∏–µ —Ä—É–∫ –Ω–∞ –±–ª–æ–∫–µ"
            ],
            "–ü–ª–µ—á–∏": [
                "–ñ–∏–º —à—Ç–∞–Ω–≥–∏ —Å –≥—Ä—É–¥–∏", "–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π —Å–∏–¥—è", "–ú–∞—Ö–∏ –≥–∞–Ω—Ç–µ–ª–µ–π –≤ —Å—Ç–æ—Ä–æ–Ω—ã",
                "–ú–∞—Ö–∏ –≥–∞–Ω—Ç–µ–ª–µ–π –≤ –Ω–∞–∫–ª–æ–Ω–µ", "–¢—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –∫ –ø–æ–¥–±–æ—Ä–æ–¥–∫—É"
            ],
            "–ù–æ–≥–∏": [
                "–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å–æ —à—Ç–∞–Ω–≥–æ–π", "–ñ–∏–º –Ω–æ–≥–∞–º–∏", "–ñ–∏–º –Ω–æ–≥–∞–º–∏ –≤–≤–µ—Ä—Ö 45 –≥—Ä–∞–¥—É—Å–æ–≤",
                "–ñ–∏–º –Ω–æ–≥–∞–º–∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–∞–∂–µ—Ä", "–°–≥–∏–±–∞–Ω–∏–µ –Ω–æ–≥ –ª–µ–∂–∞", 
                "–°–≥–∏–±–∞–Ω–∏–µ –Ω–æ–≥ –ø–æ –æ–¥–Ω–æ–π —Å—Ç–æ—è", "–†–∞–∑–≥–∏–±–∞–Ω–∏–µ –Ω–æ–≥ —Å–∏–¥—è", "–í—ã–ø–∞–¥—ã",
                "–ü–æ–¥—ä–µ–º –Ω–∞ –∏–∫—Ä—ã —Å–∏–¥—è", "–ü–æ–¥—ä–µ–º –Ω–∞ –∏–∫—Ä—ã —Å—Ç–æ—è"
            ],
            "–ö–∞—Ä–¥–∏–æ": [
                "–ë–µ–≥–æ–≤–∞—è –¥–æ—Ä–æ–∂–∫–∞", "–í–µ–ª–æ—Ç—Ä–µ–Ω–∞–∂–µ—Ä", "–≠–ª–ª–∏–ø—Å", "–°–∫–∞–∫–∞–ª–∫–∞"
            ],
            "–ü—Ä–µ—Å—Å": [
                "–°–∫—Ä—É—á–∏–≤–∞–Ω–∏—è", "–ü–æ–¥—ä–µ–º –Ω–æ–≥ –≤ –≤–∏—Å–µ", "–ü–ª–∞–Ω–∫–∞", "–†—É—Å—Å–∫–∏–π —Ç–≤–∏—Å—Ç", "–°–≤–µ—á–∫–∞"
            ]
        };
            // üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    async function initDatabase() {
        try {
            await sportDatabase.init();
            console.log('‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ');
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:', error);
        }
    }

    // üîÑ –û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –°–û–•–†–ê–ù–ï–ù–ò–Ø –¢–†–ï–ù–ò–†–û–í–ö–ò
    async function saveWorkout() {
        const completedSets = sets.filter(set => set.completed);
        if (completedSets.length === 0) {
            alert('–î–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥!');
            return;
        }

        const workout = {
            exercise: selectedExercise,
            muscleGroup: selectedGroup,
            sets: sets,
            grip: selectedGrip
        };

        try {
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –Ω–æ–≤—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
            await sportDatabase.saveCompleteWorkout(workout);
            alert(`‚úÖ –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ "${selectedExercise}" —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!\n–ü–æ–¥—Ö–æ–¥–æ–≤: ${sets.length}\n–í—ã–ø–æ–ª–Ω–µ–Ω–æ: ${completedSets.length}`);
            
            // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
            resetWorkoutForm();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            renderCalendar();
            updateAnalytics();
            showTab('home');
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
            // Fallback: —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            saveWorkoutToHistory(workout);
            alert(`–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ "${selectedExercise}" —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ (—Ä–µ–∑–µ—Ä–≤–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ)!`);
        }
    }

    // üîÑ –§—É–Ω–∫—Ü–∏—è —Å–±—Ä–æ—Å–∞ —Ñ–æ—Ä–º—ã
    function resetWorkoutForm() {
        selectedGroup = null;
        selectedExercise = null;
        sets = [{ weight: '', reps: '', completed: false }];
        selectedGrip = null;
        editingWorkout = null;
        
        document.querySelectorAll('.group-button, .exercise-button').forEach(btn => {
            btn.classList.remove('selected');
        });
        document.getElementById('exercisesSection').style.display = 'none';
        document.getElementById('setsSection').style.display = 'none';
        document.getElementById('gripSection').style.display = 'none';
        document.getElementById('saveButton').textContent = '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É';
    }

    // üîÑ –û–ë–ù–û–í–õ–Ø–ï–ú –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Æ –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
    document.addEventListener('DOMContentLoaded', function() {
        initDatabase(); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –±–∞–∑—É
        init(); // –í–∞—à–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
    });

        // –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è —Å –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π
        const exercisesWithGrip = [
            "–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å–æ —à—Ç–∞–Ω–≥–æ–π",
            "–ñ–∏–º –Ω–æ–≥–∞–º–∏",
            "–ñ–∏–º –Ω–æ–≥–∞–º–∏ –≤–≤–µ—Ä—Ö 45 –≥—Ä–∞–¥—É—Å–æ–≤",
            "–ñ–∏–º –Ω–æ–≥–∞–º–∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–∞–∂–µ—Ä"
        ];

        // –ú–∞–ø–ø–∏–Ω–≥ –≥—Ä—É–ø–ø –º—ã—à—Ü –∫ –∞–Ω–∏–º–∞—Ü–∏—è–º
        const groupAnimations = {
            "–ì—Ä—É–¥—å": "animation-chest",
            "–°–ø–∏–Ω–∞": "animation-back", 
            "–†—É–∫–∏": "animation-arms",
            "–ü–ª–µ—á–∏": "animation-shoulders",
            "–ù–æ–≥–∏": "animation-legs",
            "–ö–∞—Ä–¥–∏–æ": "animation-cardio",
            "–ü—Ä–µ—Å—Å": "animation-abs"
        };

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();
        let selectedGroup = null;
        let selectedExercise = null;
        let sets = [{ weight: '', reps: '', completed: false }];
        let muscleGroupChart = null;
        let progressChart = null;
        let deferredPrompt = null;
        let selectedGrip = null;
        let editingWorkout = null;

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ PWA
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            showInstallPrompt();
        });

        function showInstallPrompt() {
            const installPrompt = document.getElementById('installPrompt');
            installPrompt.style.display = 'flex';
            
            installPrompt.onclick = async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    if (outcome === 'accepted') {
                        console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å—Ç–∞–Ω–æ–≤–∏–ª PWA');
                    }
                    deferredPrompt = null;
                    hideInstallPrompt();
                }
            };
        }

        function hideInstallPrompt() {
            document.getElementById('installPrompt').style.display = 'none';
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ PWA
        window.addEventListener('appinstalled', () => {
            console.log('PWA —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ');
            deferredPrompt = null;
        });

        // ==================== –û–°–ù–û–í–ù–û–ô –ö–û–î ====================
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function init() {
            renderCalendar();
            initWorkout();
            updateAnalytics();
            setupEventListeners();
        }

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è
        function showTab(tabName) {
            document.querySelectorAll('.content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            if (tabName === 'analytics') {
                updateAnalytics();
            } else if (tabName === 'home') {
                renderCalendar();
            }
        }

        // ==================== –ö–ê–õ–ï–ù–î–ê–†–¨ –ò –ò–°–¢–û–†–ò–Ø ====================
        function renderCalendar() {
            const monthNames = [
                '–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', '–ú–∞—Ä—Ç', '–ê–ø—Ä–µ–ª—å', '–ú–∞–π', '–ò—é–Ω—å',
                '–ò—é–ª—å', '–ê–≤–≥—É—Å—Ç', '–°–µ–Ω—Ç—è–±—Ä—å', '–û–∫—Ç—è–±—Ä—å', '–ù–æ—è–±—Ä—å', '–î–µ–∫–∞–±—Ä—å'
            ];

            document.getElementById('currentMonth').textContent = 
                `${monthNames[currentMonth]} ${currentYear}`;

            const firstDay = new Date(currentYear, currentMonth, 1);
            const lastDay = new Date(currentYear, currentMonth + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());

            const calendarGrid = document.getElementById('calendarGrid');
            calendarGrid.innerHTML = '';

            // –î–Ω–∏ –Ω–µ–¥–µ–ª–∏
            ['–í—Å', '–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±'].forEach(day => {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = day;
                calendarGrid.appendChild(dayElement);
            });

            // –î–∞—Ç—ã
            const today = new Date();
            const workoutHistory = getWorkoutHistory();

            for (let i = 0; i < 42; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);

                const dateElement = document.createElement('div');
                dateElement.className = 'calendar-date';
                
                const dateString = formatDate(date);
                const hasWorkout = workoutHistory[dateString];
                const isToday = date.toDateString() === today.toDateString();
                const isCurrentMonth = date.getMonth() === currentMonth;

                if (!isCurrentMonth) {
                    dateElement.classList.add('other-month');
                }
                if (hasWorkout) {
                    dateElement.classList.add('has-workout');
                }
                if (isToday) {
                    dateElement.classList.add('today');
                }

                dateElement.textContent = date.getDate();
                dateElement.onclick = () => showWorkoutHistory(dateString);
                calendarGrid.appendChild(dateElement);
            }

            updateWorkoutHistory();
        }

        function changeMonth(direction) {
            currentMonth += direction;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            } else if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            renderCalendar();
        }

        function showWorkoutHistory(dateString) {
            const workoutHistory = getWorkoutHistory();
            const workouts = workoutHistory[dateString];
            
            if (workouts) {
                let historyHTML = `<div class="section-title">–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∑–∞ ${dateString}:</div>`;
                workouts.forEach((workout, index) => {
                    historyHTML += `
                        <div class="history-item">
                            <div class="history-exercise" onclick="viewWorkoutDetails('${dateString}', ${index})">
                                ${workout.exercise}
                                ${workout.grip ? ` (${getGripText(workout.grip)})` : ''}
                            </div>
                            <div class="history-details">
                                –ü–æ–¥—Ö–æ–¥–æ–≤: ${workout.sets.length} | 
                                –í—ã–ø–æ–ª–Ω–µ–Ω–æ: ${workout.sets.filter(s => s.completed).length}
                            </div>
                            <div class="action-buttons">
                                <button class="edit-button" onclick="editWorkout('${dateString}', ${index})">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                                <button class="delete-button" onclick="deleteWorkout('${dateString}', ${index})">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                            </div>
                        </div>
                    `;
                });
                document.getElementById('workoutHistory').innerHTML = historyHTML;
            } else {
                document.getElementById('workoutHistory').innerHTML = 
                    '<div class="section-title">–ù–∞ —ç—Ç—É –¥–∞—Ç—É —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –Ω–µ—Ç</div>';
            }
        }

        function updateWorkoutHistory() {
            const workoutHistory = getWorkoutHistory();
            const recentWorkouts = Object.entries(workoutHistory)
                .sort((a, b) => new Date(b[0]) - new Date(a[0]))
                .slice(0, 5);

            if (recentWorkouts.length > 0) {
                let historyHTML = '<div class="section-title">–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏:</div>';
                recentWorkouts.forEach(([date, workouts]) => {
                    workouts.forEach((workout, index) => {
                        historyHTML += `
                            <div class="history-item">
                                <div class="history-exercise" onclick="viewWorkoutDetails('${date}', ${index})">
                                    ${workout.exercise}
                                    ${workout.grip ? ` (${getGripText(workout.grip)})` : ''}
                                </div>
                                <div class="history-details">${date} | –ü–æ–¥—Ö–æ–¥–æ–≤: ${workout.sets.length}</div>
                                <div class="action-buttons">
                                    <button class="edit-button" onclick="editWorkout('${date}', ${index})">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                                    <button class="delete-button" onclick="deleteWorkout('${date}', ${index})">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                                </div>
                            </div>
                        `;
                    });
                });
                document.getElementById('workoutHistory').innerHTML = historyHTML;
            } else {
                document.getElementById('workoutHistory').innerHTML = 
                    '<div class="section-title">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</div>';
            }
        }

        // ==================== –ü–†–û–°–ú–û–¢–† –ò –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–ï –¢–†–ï–ù–ò–†–û–í–û–ö ====================
        function viewWorkoutDetails(dateString, workoutIndex) {
            const workoutHistory = getWorkoutHistory();
            const workout = workoutHistory[dateString][workoutIndex];
            
            document.getElementById('modalExerciseName').textContent = 
                `${workout.exercise}${workout.grip ? ` (${getGripText(workout.grip)})` : ''}`;
            
            let detailsHTML = '<div class="workout-details">';
            workout.sets.forEach((set, index) => {
                if (set.completed) {
                    detailsHTML += `
                        <div class="workout-set">
                            <div>–ü–æ–¥—Ö–æ–¥ ${index + 1}</div>
                            <div>${set.weight} –∫–≥ √ó ${set.reps} –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π</div>
                        </div>
                    `;
                }
            });
            detailsHTML += '</div>';
            
            document.getElementById('workoutDetails').innerHTML = detailsHTML;
            document.getElementById('workoutModal').style.display = 'flex';
        }

        function closeWorkoutModal() {
            document.getElementById('workoutModal').style.display = 'none';
        }

        function editWorkout(dateString, workoutIndex) {
            const workoutHistory = getWorkoutHistory();
            const workout = workoutHistory[dateString][workoutIndex];
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            selectedGroup = workout.muscleGroup;
            selectedExercise = workout.exercise;
            sets = workout.sets;
            selectedGrip = workout.grip || null;
            editingWorkout = { date: dateString, index: workoutIndex };
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
            showTab('workout');
            
            // –í—ã–±–∏—Ä–∞–µ–º –≥—Ä—É–ø–ø—É –∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
            document.querySelectorAll('.group-button').forEach(btn => {
                btn.classList.remove('selected');
                if (btn.textContent.includes(selectedGroup)) {
                    btn.classList.add('selected');
                }
            });
            
            renderExercises();
            document.getElementById('exercisesSection').style.display = 'block';
            
            // –í—ã–±–∏—Ä–∞–µ–º —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
            setTimeout(() => {
                document.querySelectorAll('.exercise-button').forEach(btn => {
                    btn.classList.remove('selected');
                    if (btn.textContent.includes(selectedExercise)) {
                        btn.classList.add('selected');
                    }
                });
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ—Å—Ç–∞–Ω–æ–≤–∫—É –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
                if (exercisesWithGrip.includes(selectedExercise)) {
                    document.getElementById('gripSection').style.display = 'block';
                    document.querySelectorAll('.grip-option').forEach(opt => {
                        opt.classList.remove('selected');
                        if (opt.textContent.includes(getGripText(selectedGrip))) {
                            opt.classList.add('selected');
                        }
                    });
                }
                
                renderSets();
                document.getElementById('setsSection').style.display = 'block';
                
                // –ú–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                document.getElementById('saveButton').textContent = '–û–±–Ω–æ–≤–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É';
            }, 100);
        }

        function deleteWorkout(dateString, workoutIndex) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É?')) {
                const workoutHistory = getWorkoutHistory();
                workoutHistory[dateString].splice(workoutIndex, 1);
                
                // –ï—Å–ª–∏ –Ω–∞ —ç—Ç—É –¥–∞—Ç—É –±–æ–ª—å—à–µ –Ω–µ—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫, —É–¥–∞–ª—è–µ–º –¥–∞—Ç—É
                if (workoutHistory[dateString].length === 0) {
                    delete workoutHistory[dateString];
                }
                
                localStorage.setItem('workoutHistory', JSON.stringify(workoutHistory));
                updateWorkoutHistory();
                renderCalendar();
                updateAnalytics();
            }
        }

        function getGripText(grip) {
            const gripTexts = {
                'narrow': '–£–∑–∫–∞—è',
                'medium': '–°—Ä–µ–¥–Ω—è—è', 
                'wide': '–®–∏—Ä–æ–∫–∞—è'
            };
            return gripTexts[grip] || '';
        }

        // ==================== –¢–†–ï–ù–ò–†–û–í–ö–ê ====================
        function initWorkout() {
            renderGroups();
        }

        function renderGroups() {
            const groupsContainer = document.getElementById('groupsContainer');
            groupsContainer.innerHTML = '';
            
            Object.keys(exercisesDatabase).forEach(group => {
                const button = document.createElement('button');
                button.className = 'group-button';
                button.innerHTML = `<div class="group-button-text">${group}</div>`;
                button.onclick = () => selectGroup(group);
                groupsContainer.appendChild(button);
            });
        }

        function selectGroup(group) {
            selectedGroup = group;
            selectedExercise = null;
            sets = [{ weight: '', reps: '', completed: false }];
            selectedGrip = null;
            editingWorkout = null;
            
            document.querySelectorAll('.group-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.classList.add('selected');
            
            renderExercises();
            document.getElementById('exercisesSection').style.display = 'block';
            document.getElementById('setsSection').style.display = 'none';
            document.getElementById('gripSection').style.display = 'none';
            document.getElementById('saveButton').textContent = '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É';
        }

        function renderExercises() {
            const exercisesContainer = document.getElementById('exercisesContainer');
            const exercisesTitle = document.getElementById('exercisesTitle');
            
            exercisesTitle.textContent = `2. –í—ã–±–µ—Ä–∏—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –¥–ª—è ${selectedGroup}:`;
            exercisesContainer.innerHTML = '';
            
            const animationClass = groupAnimations[selectedGroup];
            
            exercisesDatabase[selectedGroup].forEach(exercise => {
                const button = document.createElement('button');
                button.className = 'exercise-button';
                button.innerHTML = `
                    <div class="exercise-with-animation">
                        <div class="exercise-name">${exercise}</div>
                        <div class="exercise-animation ${animationClass}">
                            ${getExerciseEmoji(selectedGroup)}
                        </div>
                    </div>
                `;
                button.onclick = () => selectExercise(exercise);
                exercisesContainer.appendChild(button);
            });
        }

        function getExerciseEmoji(group) {
            const emojis = {
                "–ì—Ä—É–¥—å": "üèãÔ∏è",
                "–°–ø–∏–Ω–∞": "üí™", 
                "–†—É–∫–∏": "üí™",
                "–ü–ª–µ—á–∏": "‚¨ÜÔ∏è",
                "–ù–æ–≥–∏": "ü¶µ",
                "–ö–∞—Ä–¥–∏–æ": "üèÉ",
                "–ü—Ä–µ—Å—Å": "üîÅ"
            };
            return emojis[group] || "üí™";
        }

        function selectExercise(exercise) {
            selectedExercise = exercise;
            
            document.querySelectorAll('.exercise-button').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.classList.add('selected');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —á–µ–∫–±–æ–∫—Å—ã –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–ª—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –Ω–æ–≥
            if (exercisesWithGrip.includes(exercise)) {
                document.getElementById('gripSection').style.display = 'block';
            } else {
                document.getElementById('gripSection').style.display = 'none';
                selectedGrip = null;
            }
            
            renderSets();
            document.getElementById('setsSection').style.display = 'block';
        }

        function selectGrip(grip) {
            selectedGrip = grip;
            document.querySelectorAll('.grip-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            event.target.classList.add('selected');
        }

        function renderSets() {
            const setsContainer = document.getElementById('setsContainer');
            const selectedExerciseName = document.getElementById('selectedExerciseName');
            
            selectedExerciseName.textContent = selectedExercise;
            setsContainer.innerHTML = '';
            
            sets.forEach((set, index) => {
                const setElement = document.createElement('div');
                setElement.className = `set-container ${set.completed ? 'completed-set' : ''}`;
                setElement.innerHTML = `
                    <div class="set-number">–ü–æ–¥—Ö–æ–¥ ${index + 1}</div>
                    <div class="set-inputs">
                        <div class="input-group">
                            <div class="input-label">–í–µ—Å (–∫–≥)</div>
                            <input 
                                type="number" 
                                class="weight-input" 
                                placeholder="0" 
                                value="${set.weight}"
                                oninput="updateSet(${index}, 'weight', this.value)"
                            >
                        </div>
                        <div class="input-group">
                            <div class="input-label">–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</div>
                            <input 
                                type="number" 
                                class="reps-input" 
                                placeholder="0" 
                                value="${set.reps}"
                                oninput="updateSet(${index}, 'reps', this.value)"
                            >
                        </div>
                    </div>
                    <div class="checkbox ${set.completed ? 'completed' : ''}" onclick="toggleSet(${index})">
                        <div class="checkbox-text">${set.completed ? '‚úì' : ''}</div>
                    </div>
                `;
                setsContainer.appendChild(setElement);
            });
        }

        function updateSet(index, field, value) {
            sets[index][field] = value;
        }

        function toggleSet(index) {
            sets[index].completed = !sets[index].completed;
            renderSets();
        }

// üîÑ –û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –î–û–ë–ê–í–õ–ï–ù–ò–Ø –ü–û–î–•–û–î–ê
function addSet() {
    sets.push({ weight: '', reps: '', completed: false });
    console.log(`‚ûï –î–æ–±–∞–≤–ª–µ–Ω –ø–æ–¥—Ö–æ–¥ ${sets.length}`);
    renderSets();
}
        

 // üîÑ –£–õ–£–ß–®–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –°–û–•–†–ê–ù–ï–ù–ò–Ø –¢–†–ï–ù–ò–†–û–í–ö–ò
function saveWorkout() {
    const completedSets = sets.filter(set => set.completed);
    if (completedSets.length === 0) {
        showMessage('‚ùå –î–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥!', 'error');
        return;
    }

    const workout = {
        exercise: selectedExercise,
        muscleGroup: selectedGroup,
        sets: sets,
        date: new Date().toISOString(),
        timestamp: new Date().getTime()
    };

    // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ—Å—Ç–∞–Ω–æ–≤–∫—É –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–∞
    if (selectedGrip) {
        workout.grip = selectedGrip;
    }

    console.log('üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏:', workout);

    try {
        if (editingWorkout) {
            // –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
            updateWorkoutInHistory(editingWorkout.date, editingWorkout.index, workout);
            console.log('‚úÖ –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –≤ localStorage:', selectedExercise);
            showMessage(`‚úÖ –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ "${selectedExercise}" –æ–±–Ω–æ–≤–ª–µ–Ω–∞!`, 'success');
        } else {
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–æ–≤—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
            saveWorkoutToHistory(workout);
            console.log('‚úÖ –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ localStorage:', selectedExercise);
            showMessage(`‚úÖ –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ "${selectedExercise}" —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞! –ü–æ–¥—Ö–æ–¥–æ–≤: ${sets.length}, –í—ã–ø–æ–ª–Ω–µ–Ω–æ: ${completedSets.length}`, 'success');
        }
        
        // –ü—ã—Ç–∞–µ–º—Å—è —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ IndexedDB –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞
        if (typeof sportDatabase !== 'undefined' && sportDatabase.saveCompleteWorkout) {
            sportDatabase.saveCompleteWorkout(workout)
                .then(() => {
                    console.log('‚úÖ –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —Ç–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ IndexedDB');
                })
                .catch(error => {
                    console.log('‚ÑπÔ∏è –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –≤ localStorage');
                });
        }
        
    } catch (error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏:', error);
        showMessage('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏', 'error');
        return;
    }
    
    // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
    resetWorkoutForm();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫—É
    renderCalendar();
    updateAnalytics();
    showTab('home');
}

// üîÑ –§–£–ù–ö–¶–ò–Ø –°–ë–†–û–°–ê –§–û–†–ú–´ –¢–†–ï–ù–ò–†–û–í–ö–ò
function resetWorkoutForm() {
    selectedGroup = null;
    selectedExercise = null;
    sets = [{ weight: '', reps: '', completed: false }];
    selectedGrip = null;
    editingWorkout = null;
    
    document.querySelectorAll('.group-button, .exercise-button').forEach(btn => {
        btn.classList.remove('selected');
    });
    document.getElementById('exercisesSection').style.display = 'none';
    document.getElementById('setsSection').style.display = 'none';
    document.getElementById('gripSection').style.display = 'none';
    document.getElementById('saveButton').textContent = '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É';
}

// üîÑ –§–£–ù–ö–¶–ò–Ø –ü–û–ö–ê–ó–ê –ö–†–ê–°–ò–í–´–• –£–í–ï–î–û–ú–õ–ï–ù–ò–ô
function showMessage(message, type) {
    // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è
    const messageDiv = document.createElement('div');
    messageDiv.textContent = message;
    messageDiv.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 15px 20px;
        border-radius: 8px;
        color: white;
        font-weight: bold;
        z-index: 10000;
        opacity: 0;
        transition: opacity 0.3s ease-in-out;
        max-width: 300px;
        word-wrap: break-word;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        ${type === 'success' ? 'background-color: #34C759;' : 'background-color: #FF3B30;'}
    `;

    document.body.appendChild(messageDiv);

    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    setTimeout(() => {
        messageDiv.style.opacity = '1';
    }, 100);

    // –£–±–∏—Ä–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 4 —Å–µ–∫—É–Ω–¥—ã
    setTimeout(() => {
        messageDiv.style.opacity = '0';
        setTimeout(() => {
            if (messageDiv.parentNode) {
                messageDiv.parentNode.removeChild(messageDiv);
            }
        }, 300);
    }, 4000);
}
        // ==================== –ê–ù–ê–õ–ò–¢–ò–ö–ê ====================
        function updateAnalytics() {
            const workoutHistory = getWorkoutHistory();
            const allWorkouts = getAllWorkouts();
            
            // –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            document.getElementById('totalWorkouts').textContent = allWorkouts.length;
            
            const thisMonth = new Date().getMonth();
            const monthWorkouts = allWorkouts.filter(workout => 
                new Date(workout.date).getMonth() === thisMonth
            );
            document.getElementById('monthWorkouts').textContent = monthWorkouts.length;
            
            // –ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ –≥—Ä—É–ø–ø–∞–º –º—ã—à—Ü
            updateMuscleGroupChart(allWorkouts);
            
            // –ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
            updateProgressChart(allWorkouts);
        }

        function updateMuscleGroupChart(workouts) {
            const muscleGroups = {};
            
            workouts.forEach(workout => {
                const group = workout.muscleGroup;
                muscleGroups[group] = (muscleGroups[group] || 0) + 1;
            });

            const ctx = document.getElementById('muscleGroupChart').getContext('2d');
            
            if (muscleGroupChart) {
                muscleGroupChart.destroy();
            }

            const colors = ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40', '#FF6384'];
            
            muscleGroupChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(muscleGroups),
                    datasets: [{
                        data: Object.values(muscleGroups),
                        backgroundColor: colors,
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        title: {
                            display: true,
                            text: '–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –≥—Ä—É–ø–ø–∞–º –º—ã—à—Ü'
                        }
                    }
                }
            });
        }

        function updateProgressChart(workouts) {
            const ctx = document.getElementById('progressChart').getContext('2d');
            
            if (progressChart) {
                progressChart.destroy();
            }

            // –ü—Ä–æ—Å—Ç–æ–π –≥—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (–º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å)
            const lastWorkouts = workouts.slice(-10).reverse();
            const labels = lastWorkouts.map((_, i) => `–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ ${i + 1}`);
            const data = lastWorkouts.map(workout => {
                const completedSets = workout.sets.filter(set => set.completed);
                return completedSets.reduce((sum, set) => sum + (parseInt(set.weight) || 0), 0);
            });

            progressChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '–°—É–º–º–∞—Ä–Ω—ã–π –≤–µ—Å (–∫–≥)',
                        data: data,
                        borderColor: '#007AFF',
                        backgroundColor: 'rgba(0, 122, 255, 0.1)',
                        borderWidth: 2,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: '–ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞–º'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // ==================== –•–†–ê–ù–ï–ù–ò–ï –î–ê–ù–ù–´–• ====================
        function getWorkoutHistory() {
            return JSON.parse(localStorage.getItem('workoutHistory') || '{}');
        }

        function getAllWorkouts() {
            const history = getWorkoutHistory();
            const allWorkouts = [];
            
            Object.values(history).forEach(workouts => {
                allWorkouts.push(...workouts);
            });
            
            return allWorkouts.sort((a, b) => new Date(a.date) - new Date(b.date));
        }

        function saveWorkoutToHistory(workout) {
            const history = getWorkoutHistory();
            const dateString = formatDate(new Date());
            
            if (!history[dateString]) {
                history[dateString] = [];
            }
            
            history[dateString].push(workout);
            localStorage.setItem('workoutHistory', JSON.stringify(history));
        }

        function updateWorkoutInHistory(dateString, workoutIndex, updatedWorkout) {
            const history = getWorkoutHistory();
            history[dateString][workoutIndex] = updatedWorkout;
            localStorage.setItem('workoutHistory', JSON.stringify(history));
        }

        function formatDate(date) {
            return date.toISOString().split('T')[0];
        }

        // ==================== –°–õ–£–®–ê–¢–ï–õ–ò –°–û–ë–´–¢–ò–ô ====================
        function setupEventListeners() {
            document.getElementById('addSetButton').onclick = addSet;
            document.getElementById('saveButton').onclick = saveWorkout;
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
        document.addEventListener('DOMContentLoaded', init);
    </script>

    <script>
    // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Service Worker —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.getRegistrations().then(registrations => {
          if (registrations.length > 0) {
            console.log('‚úÖ Service Worker —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω');
            return;
          }
          
          navigator.serviceWorker.register('./sw.js')
            .then(function(registration) {
              console.log('‚úÖ Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:', registration.scope);
              
              if (registration.installing) {
                console.log('üì• Service Worker —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è');
              } else if (registration.waiting) {
                console.log('‚è≥ Service Worker –æ–∂–∏–¥–∞–µ—Ç –∞–∫—Ç–∏–≤–∞—Ü–∏–∏');
              } else if (registration.active) {
                console.log('üéâ Service Worker –∞–∫—Ç–∏–≤–µ–Ω!');
              }
            })
            .catch(function(error) {
              console.log('‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ Service Worker:', error);
            });
        });
      });
    }
    </script>

</body>
</html>
