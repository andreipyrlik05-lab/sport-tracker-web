<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sport Tracker Pro</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#007AFF">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Sport Tracker Pro">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) */
            --bg-primary: #0a0a0a;
            --bg-secondary: #111111;
            --bg-card: #1a1a1a;
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --accent-primary: #00d9ff;
            --accent-secondary: #b400ff;
            --success: #00ff88;
            --warning: #ffaa00;
            --error: #ff0066;
            --border: #333333;
            --shadow: rgba(0, 0, 0, 0.3);
            --nav-shadow: rgba(0, 217, 255, 0.4);
        }

        [data-theme="light"] {
            /* –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ */
            --bg-primary: #ffffff;
            --bg-secondary: #f5f5f7;
            --bg-card: #ffffff;
            --text-primary: #1a1a1a;
            --text-secondary: #666666;
            --accent-primary: #007AFF;
            --accent-secondary: #5856D6;
            --success: #34C759;
            --warning: #FF9500;
            --error: #FF3B30;
            --border: #e5e5e7;
            --shadow: rgba(0, 0, 0, 0.1);
            --nav-shadow: rgba(0, 122, 255, 0.2);
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            transition: background-color 0.3s, color 0.3s;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background: var(--bg-secondary);
            min-height: 100vh;
            position: relative;
            transition: background-color 0.3s;
        }

        .nav {
            display: flex;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 25px var(--nav-shadow);
        }

        .nav-button {
            flex: 1;
            padding: 15px;
            background: none;
            border: none;
            color: white;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        .nav-button.active {
            background: rgba(255, 255, 255, 0.15);
        }

        .nav-button:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 3px;
            background: white;
            transition: all 0.3s;
            transform: translateX(-50%);
            box-shadow: 0 0 10px white;
        }

        .nav-button.active:after {
            width: 80%;
        }

        .logout-nav {
            flex: 0.5;
            background: rgba(255, 0, 102, 0.2);
            font-size: 12px;
            min-width: 60px;
            transition: all 0.3s;
        }

        .logout-nav:hover {
            transform: scale(1.05);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è —Ç–µ–º */
        .theme-toggle-container {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px 20px;
            background: var(--bg-card);
            border-bottom: 1px solid var(--border);
        }

        .theme-toggle {
            background: var(--bg-secondary);
            border: 2px solid var(--accent-primary);
            border-radius: 25px;
            padding: 8px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
            font-size: 14px;
            color: var(--text-primary);
        }

        .theme-toggle:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px var(--nav-shadow);
        }

        .theme-icon {
            font-size: 18px;
            transition: transform 0.3s;
        }

        .theme-toggle.active .theme-icon {
            transform: rotate(180deg);
        }

        .content {
            padding: 20px;
            display: none;
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .content.active {
            display: block;
        }

        .title {
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
            color: var(--text-primary);
            text-shadow: 0 0 20px rgba(0, 217, 255, 0.3);
            transition: color 0.3s;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-top: 20px;
            margin-bottom: 10px;
            color: var(--text-primary);
            transition: color 0.3s;
        }

        .calendar {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
            box-shadow: 0 4px 20px var(--shadow);
            transition: all 0.3s;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .calendar-nav {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .calendar-nav:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px var(--nav-shadow);
        }

        .calendar-month {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            transition: color 0.3s;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        .calendar-day {
            text-align: center;
            font-size: 12px;
            color: var(--text-secondary);
            padding: 5px;
            font-weight: 500;
            transition: color 0.3s;
        }

        .calendar-date {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            position: relative;
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border: 1px solid var(--border);
        }

        .calendar-date.has-workout {
            background: linear-gradient(135deg, var(--success), #00cc66);
            color: #0a0a0a;
            font-weight: bold;
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.4);
        }

        .calendar-date.today {
            border: 2px solid var(--accent-primary);
            background: var(--accent-primary);
            color: #0a0a0a;
            font-weight: bold;
            box-shadow: 0 0 15px var(--nav-shadow);
        }

        .calendar-date.other-month {
            color: var(--text-secondary);
            opacity: 0.5;
        }

        .calendar-date.selected {
            border: 3px solid var(--accent-primary) !important;
            background: var(--accent-primary) !important;
            color: #0a0a0a !important;
            font-weight: bold;
            transform: scale(1.1);
            box-shadow: 0 0 20px var(--nav-shadow);
        }

        .workout-history {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 15px;
            margin-top: 20px;
            border: 1px solid var(--border);
            box-shadow: 0 4px 20px var(--shadow);
            transition: all 0.3s;
        }

        .history-item {
            padding: 15px;
            border-bottom: 1px solid var(--border);
            transition: all 0.3s;
            border-radius: 12px;
            margin-bottom: 8px;
            background: var(--bg-secondary);
        }

        .history-item:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateX(5px);
            box-shadow: 0 0 15px var(--nav-shadow);
        }

        [data-theme="light"] .history-item:hover {
            background: rgba(0, 0, 0, 0.02);
        }

        .history-exercise {
            font-weight: 500;
            margin-bottom: 5px;
            cursor: pointer;
            transition: color 0.3s;
            font-size: 18px;
            color: var(--text-primary);
        }

        .history-exercise:hover {
            color: var(--accent-primary);
            text-shadow: 0 0 10px var(--nav-shadow);
        }

        .history-details {
            font-size: 14px;
            color: var(--text-secondary);
            transition: color 0.3s;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .edit-button,
        .delete-button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .edit-button {
            background: linear-gradient(135deg, #ffaa00, #ffcc00);
            color: #0a0a0a;
            font-weight: 600;
        }

        .delete-button {
            background: linear-gradient(135deg, #ff0066, #ff3385);
            color: white;
        }

        .groups-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .group-button {
            background: var(--bg-card);
            padding: 20px;
            border-radius: 16px;
            border: 1px solid var(--border);
            flex: 1 1 calc(50% - 10px);
            min-width: 140px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .group-button.selected {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: #0a0a0a;
            transform: scale(1.05);
            box-shadow: 0 0 25px var(--nav-shadow);
            border-color: var(--accent-primary);
        }

        .exercise-button {
            background: var(--bg-card);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid var(--border);
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            text-align: left;
            color: var(--text-primary);
            font-size: 16px;
        }

        .exercise-button.selected {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: #0a0a0a;
            border-color: var(--accent-primary);
            transform: scale(1.02);
            box-shadow: 0 0 20px var(--nav-shadow);
        }

        .set-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-card);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 10px;
            border: 1px solid var(--border);
            gap: 10px;
            flex-wrap: wrap;
        }

        .cardio-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-card);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 10px;
            border: 1px solid var(--border);
            gap: 10px;
            flex-wrap: wrap;
        }

        .set-inputs {
            display: flex;
            gap: 10px;
            flex: 1;
            min-width: 200px;
        }

        .cardio-inputs {
            display: flex;
            gap: 10px;
            flex: 1;
            min-width: 200px;
        }

        .weight-input,
        .reps-input,
        .time-input,
        .intensity-input,
        .body-weight-input {
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 14px;
            width: 100%;
            background: var(--bg-secondary);
            color: var(--text-primary);
            transition: all 0.3s;
        }

        .add-button,
        .save-button,
        .auth-button {
            padding: 15px;
            border-radius: 12px;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-bottom: 10px;
            transition: all 0.3s;
        }

        .add-button {
            background: linear-gradient(135deg, var(--success), #00cc66);
            color: #0a0a0a;
        }

        .save-button {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
        }

        .auth-button {
            background: linear-gradient(135deg, #FFAA00, #FFCC00);
            color: #0a0a0a;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: var(--bg-card);
            padding: 20px;
            border-radius: 16px;
            text-align: center;
            border: 1px solid var(--border);
            transition: all 0.3s;
        }

        .stat-value {
            font-size: 28px;
            font-weight: bold;
            color: var(--accent-primary);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-secondary);
            font-weight: 500;
            transition: color 0.3s;
        }

        .chart-container {
            background: var(--bg-card);
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
            transition: all 0.3s;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, var(--success), #00cc66);
            color: #0a0a0a;
            padding: 15px 20px;
            border-radius: 12px;
            z-index: 1001;
            transform: translateX(150%);
            transition: transform 0.3s ease-out;
        }

        .notification.show {
            transform: translateX(0);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--bg-card);
            padding: 20px;
            border-radius: 16px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            transition: all 0.3s;
        }

        .modal-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
            color: var(--text-primary);
            transition: color 0.3s;
        }

        .workout-set {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid var(--border);
            transition: border-color 0.3s;
        }

        .close-modal {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            width: 100%;
            margin-top: 15px;
            font-size: 16px;
        }

        .motivation-section {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid var(--border);
            box-shadow: 0 4px 20px var(--shadow);
            text-align: center;
            transition: all 0.3s;
        }

        .motivation-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            color: var(--accent-primary);
            text-shadow: 0 0 10px var(--nav-shadow);
            transition: color 0.3s;
        }

        .motivation-image {
            width: 100%;
            max-width: 300px;
            height: auto;
            border-radius: 12px;
            margin: 10px 0;
            border: 2px solid var(--accent-primary);
            box-shadow: 0 0 20px var(--nav-shadow);
        }

        .motivation-text {
            font-size: 16px;
            color: var(--text-primary);
            margin: 15px 0;
            line-height: 1.5;
            transition: color 0.3s;
        }

        .motivation-quote {
            font-style: italic;
            color: var(--text-secondary);
            margin-top: 10px;
            font-size: 14px;
            transition: color 0.3s;
        }

        .backup-section {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid var(--border);
            text-align: center;
            transition: all 0.3s;
        }

        .backup-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: var(--accent-primary);
            transition: color 0.3s;
        }

        .backup-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .export-button,
        .import-button {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 150px;
        }

        .export-button {
            background: linear-gradient(135deg, #007AFF, #00d9ff);
            color: white;
        }

        .import-button {
            background: linear-gradient(135deg, var(--success), #00cc66);
            color: #0a0a0a;
        }

        .export-button:hover,
        .import-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px var(--nav-shadow);
        }

        .file-input {
            display: none;
        }

        .auth-section {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
            text-align: center;
            transition: all 0.3s;
        }

        .auth-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            color: var(--accent-primary);
            transition: color 0.3s;
        }

        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .auth-input {
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 14px;
            transition: all 0.3s;
        }

        .user-info {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
            text-align: center;
            transition: all 0.3s;
        }

        .user-email {
            font-size: 16px;
            color: var(--text-primary);
            margin-bottom: 10px;
            transition: color 0.3s;
        }

        .sync-status {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 10px;
            transition: color 0.3s;
        }

        .sync-status.syncing {
            color: var(--accent-primary);
        }

        .sync-status.synced {
            color: var(--success);
        }

        .sync-status.error {
            color: var(--error);
        }

        .forgot-password-link {
            color: var(--accent-primary);
            text-decoration: none;
            font-size: 14px;
            cursor: pointer;
            transition: color 0.3s;
            display: inline-block;
            margin-top: 10px;
        }

        .forgot-password-link:hover {
            color: var(--accent-secondary);
            text-shadow: 0 0 10px var(--nav-shadow);
        }

        .workout-date-display {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
            text-align: center;
            font-size: 16px;
            font-weight: 600;
            color: var(--accent-primary);
            transition: all 0.3s;
        }

        .body-weight-section {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
            transition: all 0.3s;
        }

        .body-weight-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--text-primary);
            transition: color 0.3s;
        }

        .body-weight-input-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .body-weight-label {
            font-size: 14px;
            color: var(--text-secondary);
            min-width: 120px;
            transition: color 0.3s;
        }

        @media (max-width: 480px) {
            .container {
                max-width: 100%;
            }

            .nav-button {
                padding: 12px 8px;
                font-size: 12px;
            }

            .logout-nav {
                font-size: 10px;
                padding: 12px 5px;
                min-width: 50px;
            }

            .content {
                padding: 15px;
            }

            .set-inputs,
            .cardio-inputs {
                flex-direction: column;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .backup-buttons {
                flex-direction: column;
            }

            .export-button,
            .import-button {
                min-width: 100%;
            }

            .body-weight-input-container {
                flex-direction: column;
                align-items: flex-start;
            }

            .body-weight-label {
                min-width: auto;
            }

            .theme-toggle {
                font-size: 12px;
                padding: 6px 12px;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="notification" id="notification"></div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–µ—Ç–∞–ª–µ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ -->
        <div class="modal" id="workoutModal">
            <div class="modal-content">
                <div class="modal-title" id="modalExerciseName"></div>
                <div class="workout-details" id="workoutDetails"></div>
                <button class="close-modal" onclick="app.closeWorkoutModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è -->
        <div class="modal" id="forgotPasswordModal">
            <div class="modal-content">
                <div class="modal-title">üîê –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è</div>
                <div style="margin-bottom: 15px; color: var(--text-secondary); font-size: 14px;">
                    –í–≤–µ–¥–∏—Ç–µ –≤–∞—à email, –∏ –º—ã –æ—Ç–ø—Ä–∞–≤–∏–º —Å—Å—ã–ª–∫—É –¥–ª—è —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è
                </div>
                <input type="email" id="forgotPasswordEmail" class="auth-input" placeholder="–í–∞—à email"
                    style="margin-bottom: 15px;">
                <div class="sync-status" id="forgotPasswordStatus"></div>
                <div style="display: flex; gap: 10px;">
                    <button class="close-modal" onclick="app.sendPasswordReset()"
                        style="flex: 1; background: linear-gradient(135deg, var(--success), #00cc66);">
                        –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É
                    </button>
                    <button class="close-modal" onclick="app.closeForgotPassword()"
                        style="flex: 1; background: linear-gradient(135deg, #ff0066, #ff3385);">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                </div>
            </div>
        </div>

        <div class="nav">
            <button class="nav-button active" onclick="app.showTab('home')">üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å</button>
            <button class="nav-button" onclick="app.showTab('workout')">üí™ –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</button>
            <button class="nav-button" onclick="app.showTab('analytics')">üéØ –ü—Ä–æ–≥—Ä–µ—Å—Å</button>
            <button class="nav-button logout-nav" onclick="app.signOut()" style="display: none;">üö™ –í—ã–π—Ç–∏</button>
        </div>

        <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º –ø–æ–¥ –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π -->
        <div class="theme-toggle-container">
            <button class="theme-toggle" onclick="app.toggleTheme()">
                <span class="theme-icon" id="themeIcon">üåô</span>
                <span id="themeText">–¢–µ–º–Ω–∞—è —Ç–µ–º–∞</span>
            </button>
        </div>

        <div id="home" class="content active">
            <div class="title">–ú–æ–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</div>

            <!-- –°–µ–∫—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
            <div class="auth-section" id="authSection">
                <div class="auth-title">üîê –í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>
                <div class="auth-form">
                    <form onsubmit="return false;">
                        <input type="email" id="authEmail" class="auth-input" placeholder="Email" required>
                        <input type="password" id="authPassword" class="auth-input" placeholder="–ü–∞—Ä–æ–ª—å"
                            autocomplete="current-password" required>
                        <button class="auth-button" onclick="app.signIn()">–í–æ–π—Ç–∏</button>
                        <button class="auth-button" onclick="app.signUp()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                    </form>
                </div>

                <!-- –°—Å—ã–ª–∫–∞ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è -->
                <a href="#" onclick="app.showForgotPassword()" class="forgot-password-link">
                    –ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?
                </a>

                <div class="sync-status" id="authStatus"></div>
            </div>

            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ -->
            <div class="user-info" id="userInfo" style="display: none;">
                <div class="user-email" id="userEmail"></div>
            </div>

            <div class="calendar">
                <div class="calendar-header">
                    <button class="calendar-nav" onclick="app.changeMonth(-1)">‚Üê</button>
                    <div class="calendar-month" id="currentMonth"></div>
                    <button class="calendar-nav" onclick="app.changeMonth(1)">‚Üí</button>
                </div>
                <div class="calendar-grid" id="calendarGrid"></div>
            </div>

            <div class="workout-history" id="dateWorkouts" style="display: none;"></div>

            <div class="motivation-section" id="motivationBlock">
                <div class="motivation-title">üí™ –î–≤–∏–≥–∞–π—Å—è –∫ —Ü–µ–ª–∏!</div>
                <div class="motivation-text">
                    –ö–∞–∂–¥–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è —Å–∏–ª—å–Ω–µ–µ. –ù–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Å—è!
                </div>
                <svg class="motivation-image" viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" stop-color="#007AFF" />
                            <stop offset="100%" stop-color="#00d9ff" />
                        </linearGradient>
                        <linearGradient id="dumbbellGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" stop-color="#FFAA00" />
                            <stop offset="100%" stop-color="#FFCC00" />
                        </linearGradient>
                    </defs>

                    <rect width="200" height="120" fill="url(#bgGradient)" rx="10" />

                    <rect x="70" y="50" width="60" height="8" fill="url(#dumbbellGradient)" rx="4" />
                    <rect x="60" y="45" width="10" height="18" fill="url(#dumbbellGradient)" rx="2" />
                    <rect x="130" y="45" width="10" height="18" fill="url(#dumbbellGradient)" rx="2" />

                    <circle cx="50" cy="30" r="3" fill="#00FF88" opacity="0.8">
                        <animate attributeName="r" values="3;5;3" dur="2s" repeatCount="indefinite" />
                    </circle>
                    <circle cx="150" cy="25" r="2" fill="#00FF88" opacity="0.6">
                        <animate attributeName="r" values="2;4;2" dur="1.5s" repeatCount="indefinite" />
                    </circle>
                    <circle cx="180" cy="40" r="4" fill="#00FF88" opacity="0.7">
                        <animate attributeName="r" values="4;6;4" dur="2.5s" repeatCount="indefinite" />
                    </circle>

                    <text x="100" y="90" text-anchor="middle" fill="white" font-family="Arial" font-size="12"
                        font-weight="bold">
                        –¢–í–û–ô –ü–£–¢–¨ –ö –°–ò–õ–ï
                    </text>
                </svg>
                <div class="motivation-quote">
                    "–ü–æ–±–µ–¥–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å —Ä–µ—à–µ–Ω–∏—è –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å"
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞/–∏–º–ø–æ—Ä—Ç–∞ -->
            <div class="backup-section" id="backupSection" style="display: none;">
                <div class="backup-title">üì¶ –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ</div>
                <div class="backup-buttons">
                    <button class="export-button" onclick="app.exportData()">
                        üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                    </button>
                    <label class="import-button">
                        üì• –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                        <input type="file" class="file-input" accept=".json" onchange="app.importData(event)">
                    </label>
                </div>
                <div style="margin-top: 15px; font-size: 12px; color: var(--text-secondary);">
                    –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–ª–∏ –ø–µ—Ä–µ–Ω–æ—Å–∞ –Ω–∞ –¥—Ä—É–≥–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
                </div>
            </div>
        </div>

        <div id="workout" class="content">
            <div class="title">–ù–æ–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</div>

            <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞—Ç—ã —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ -->
            <div class="workout-date-display" id="workoutDateDisplay">
                üìÖ –î–∞—Ç–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏: <span id="selectedDateText">–°–µ–≥–æ–¥–Ω—è</span>
            </div>

            <!-- –°–µ–∫—Ü–∏—è –¥–ª—è –≤–≤–æ–¥–∞ –≤–µ—Å–∞ —Ç–µ–ª–∞ -->
            <div class="body-weight-section" id="bodyWeightSection" style="display: none;">
                <div class="body-weight-title">üèãÔ∏è –í–∞—à –≤–µ—Å –Ω–∞ –º–æ–º–µ–Ω—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (–∫–≥):</div>
                <div class="body-weight-input-container">
                    <span class="body-weight-label">–¢–µ–∫—É—â–∏–π –≤–µ—Å:</span>
                    <input type="number" id="bodyWeightInput" class="body-weight-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –≤–µ—Å"
                        min="30" max="300" step="0.1">
                </div>
                <div style="margin-top: 10px; font-size: 12px; color: var(--text-secondary);">
                    –£–∫–∞–∂–∏—Ç–µ –≤–∞—à —Ç–µ–∫—É—â–∏–π –≤–µ—Å –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                </div>
            </div>

            <div class="section-title">1. –í—ã–±–µ—Ä–∏—Ç–µ –≥—Ä—É–ø–ø—É –º—ã—à—Ü:</div>
            <div class="groups-container" id="groupsContainer"></div>

            <div id="exercisesSection" style="display: none;">
                <div class="section-title" id="exercisesTitle">2. –í—ã–±–µ—Ä–∏—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ:</div>
                <div class="exercises-container" id="exercisesContainer"></div>
            </div>

            <div id="setsSection" style="display: none;">
                <div class="section-title" id="setsTitle">3. –ü–æ–¥—Ö–æ–¥—ã –¥–ª—è: <span id="selectedExerciseName"></span></div>
                <div id="setsContainer"></div>
                <button class="add-button" onclick="app.addSet()">+ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Ö–æ–¥</button>
                <button class="save-button" onclick="app.saveWorkout()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É</button>
            </div>
        </div>

        <div id="analytics" class="content">
            <div class="title">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</div>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalWorkouts">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="monthWorkouts">0</div>
                    <div class="stat-label">–ó–∞ —ç—Ç–æ—Ç –º–µ—Å—è—Ü</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalSets">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –ø–æ–¥—Ö–æ–¥–æ–≤</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="avgWeight">0</div>
                    <div class="stat-label">–°—Ä–µ–¥–Ω–∏–π –≤–µ—Å (–∫–≥)</div>
                </div>
            </div>
            <div class="chart-container">
                <canvas id="muscleGroupChart"></canvas>
            </div>
            <div class="chart-container">
                <canvas id="progressChart"></canvas>
            </div>

            <!-- –°–µ–∫—Ü–∏—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ —Ç–æ–∂–µ -->
            <div class="backup-section" id="analyticsBackupSection" style="display: none;">
                <div class="backup-title">üì¶ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏</div>
                <div class="backup-buttons">
                    <button class="export-button" onclick="app.exportData()">
                        üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                    </button>
                    <label class="import-button">
                        üì• –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                        <input type="file" class="file-input" accept=".json" onchange="app.importData(event)">
                    </label>
                </div>
            </div>
        </div>
    </div>

    <script>
        // üî• Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDTE7ZKjxmTSxxvnrGB4hzE_3If1nAN1Vc",
            authDomain: "sport-tracker-pro.firebaseapp.com",
            projectId: "sport-tracker-pro",
            storageBucket: "sport-tracker-pro.firebasestorage.app",
            messagingSenderId: "617530545146",
            appId: "1:617530545146:web:0374f5ab27c374ef5c4a43"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        const app = {
            exercisesDatabase: {
                "–ì—Ä—É–¥—å": ["–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ø–æ–¥ —É–≥–ª–æ–º", "–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –Ω–∞ –ø—Ä—è–º–æ–π —Å–∫–∞–º—å–µ", "–ñ–∏–º —à—Ç–∞–Ω–≥–∏ –Ω–∞ –ø—Ä—è–º–æ–π —Å–∫–∞–º—å–µ", "–ñ–∏–º —à—Ç–∞–Ω–≥–∏ –ø–æ–¥ —É–≥–ª–æ–º", "–ñ–∏–º –æ—Ç –≥—Ä—É–¥–∏ –≤ —Ç—Ä–µ–Ω–∞–∂–µ—Ä–µ —Å–∏–¥—è", "–ñ–∏–º –æ—Ç –≥—Ä—É–¥–∏ –≤ —Ç—Ä–µ–Ω–∞–∂–µ—Ä–µ –ª–µ–∂–∞", "–†–∞–∑–≤–µ–¥–µ–Ω–∏–µ –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞", "–°–≤–µ–¥–µ–Ω–∏–µ —Ä—É–∫ –≤ –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–µ", "–°–≤–µ–¥–µ–Ω–∏–µ —Ä—É–∫ –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ ¬´–ë–∞–±–æ—á–∫–∞¬ª"],
                "–°–ø–∏–Ω–∞": ["–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è", "–¢—è–≥–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ –±–ª–æ–∫–∞ –∫ –≥—Ä—É–¥–∏", "–¢—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ", "–¢—è–≥–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –±–ª–æ–∫–∞ –∫ –ø–æ—è—Å—É", "–¢—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞ –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ ¬´–•–∞–º–º–µ—Ä¬ª", "–¢—è–≥–∞ –±–ª–æ–∫–∞ –≤ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ —Å —É–ø–æ—Ä–æ–º –≥—Ä—É–¥–∏", "–¢—è–≥–∞ —Ç-–≥—Ä–∏—Ñ–∞ —Å —É–ø–æ—Ä–æ–º"],
                "–†—É–∫–∏": ["–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–≥–∏–±–∞–Ω–∏—è –Ω–∞ –±–∏—Ü–µ–ø—Å —Å–∏–¥—è", "–ü–æ–¥—ä–µ–º –≥–∞–Ω—Ç–µ–ª–µ–π –Ω–∞ –±–∏—Ü–µ–ø—Å", "–ü–æ–¥—ä–µ–º —à—Ç–∞–Ω–≥–∏ –Ω–∞ –±–∏—Ü–µ–ø—Å", "–†–∞–∑–≥–∏–±–∞–Ω–∏–µ —Ä—É–∫ –≤ –±–ª–æ—á–Ω–æ–º —Ç—Ä–µ–Ω–∞–∂–µ—Ä–µ", "–†–∞–∑–≥–∏–±–∞–Ω–∏–µ —Ä—É–∫ —Å –≥–∞–Ω—Ç–µ–ª—å—é –≤ –Ω–∞–∫–ª–æ–Ω–µ", "–†–∞–∑–≥–∏–±–∞–Ω–∏–µ —Ä—É–∫ —Å –≥–∞–Ω—Ç–µ–ª—å—é –∏–∑-–∑–∞ –≥–æ–ª–æ–≤—ã", "–†–∞–∑–≥–∏–±–∞–Ω–∏–µ —Å –∫–∞–Ω–∞—Ç–æ–º –Ω–∞ —Ç—Ä–∏—Ü–µ–ø—Å", "–°–≥–∏–±–∞–Ω–∏–µ ¬´–ú–æ–ª–æ—Ç¬ª (¬´–ú–æ–ª–æ—Ç–∫–∏¬ª)", "–°–≥–∏–±–∞–Ω–∏–µ —Ä—É–∫ –≤ –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–µ", "–°–≥–∏–±–∞–Ω–∏–µ —Ä—É–∫ –Ω–∞ —Å–∫–∞–º—å–µ –°–∫–æ—Ç—Ç–∞", "–°–≥–∏–±–∞–Ω–∏–µ —Ä—É–∫ —Å –Ω–∏–∂–Ω–µ–≥–æ –±–ª–æ–∫–∞ —Å –∫–∞–Ω–∞—Ç–æ–º/—Ä—É–∫–æ—è—Ç—å—é", "–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π –∂–∏–º"],
                "–ü–ª–µ—á–∏": ["–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π —Å–∏–¥—è", "–ñ–∏–º –Ω–∞–¥ –≥–æ–ª–æ–≤–æ–π –≤ —Ç—Ä–µ–Ω–∞–∂–µ—Ä–µ", "–ñ–∏–º —à—Ç–∞–Ω–≥–∏ —Å –≥—Ä—É–¥–∏", "–ú–∞—Ö–∏ –≥–∞–Ω—Ç–µ–ª–µ–π –≤ —Å—Ç–æ—Ä–æ–Ω—ã", "–ú–∞—Ö–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—É –≤ –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–µ", "–ú–∞—Ö–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—É –≤ —Ç—Ä–µ–Ω–∞–∂–µ—Ä–µ", "–ü–æ–¥—ä–µ–º –≥–∞–Ω—Ç–µ–ª–µ–π –ø–µ—Ä–µ–¥ —Å–æ–±–æ–π", "–ü–æ–¥—ä–µ–º —Ä—É–∫–∏ –ø–µ—Ä–µ–¥ —Å–æ–±–æ–π –≤ –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–µ", "–†–∞–∑–≤–µ–¥–µ–Ω–∏–µ —Ä—É–∫ –≤ –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–µ –Ω–∞ –∑–∞–¥–Ω–∏–µ –¥–µ–ª—å—Ç—ã", "–†–∞–∑–≤–µ–¥–µ–Ω–∏–µ —Ä—É–∫ –≤ —Ç—Ä–µ–Ω–∞–∂–µ—Ä–µ –Ω–∞ –∑–∞–¥–Ω–∏–µ –¥–µ–ª—å—Ç—ã", "–¢—è–≥–∞ –∫–∞–Ω–∞—Ç–æ–≤ –Ω–∞ –∑–∞–¥–Ω–∏–µ –¥–µ–ª—å—Ç—ã", "–¢—è–≥–∞ –∫ –ø–æ–¥–±–æ—Ä–æ–¥–∫—É –≤ –∫—Ä–æ—Å—Å–æ–≤–µ—Ä–µ", "–¢—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –∫ –ø–æ–¥–±–æ—Ä–æ–¥–∫—É"],
                "–ù–æ–≥–∏": ["–ñ–∏–º –Ω–æ–≥–∞–º–∏", "–ñ–∏–º –Ω–æ–≥–∏ –ø–æ–¥ —É–≥–ª–æ–º", "–ò–∫—Ä–æ–Ω–æ–∂–Ω—ã–µ –º—ã—à—Ü—ã", "–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å–æ —à—Ç–∞–Ω–≥–æ–π", "–†–∞–∑–≥–∏–±–∞–Ω–∏–µ –Ω–æ–≥ (–ø–æ –æ–¥–Ω–æ–π –Ω–æ–≥–µ)", "–†–∞–∑–≥–∏–±–∞–Ω–∏–µ –Ω–æ–≥ —Å–∏–¥—è", "–°–≥–∏–±–∞–Ω–∏–µ –Ω–æ–≥ —Å—Ç–æ—è (–ø–æ –æ–¥–Ω–æ–π –Ω–æ–≥–µ)", "–°–≥–∏–±–∞–Ω–∏–µ –Ω–æ–≥ –ª–µ–∂–∞"],
                "–ö–∞—Ä–¥–∏–æ": ["–ë–µ–≥–æ–≤–∞—è –¥–æ—Ä–æ–∂–∫–∞", "–í–µ–ª–æ—Ç—Ä–µ–Ω–∞–∂–µ—Ä", "–®–∞–≥–∏ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ (–°—Ç–µ–ø-–∞–ø)", "–≠–ª–ª–∏–ø—Å"],
                "–ü—Ä–µ—Å—Å": ["–ü–ª–∞–Ω–∫–∞", "–ü–æ–¥—ä–µ–º –Ω–æ–≥ –≤ –≤–∏—Å–µ", "–®–∞–≥–∏ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ (–°—Ç–µ–ø-–∞–ø)", "–°–∫—Ä—É—á–∏–≤–∞–Ω–∏—è"]
            },

            state: {
                selectedWorkoutDate: null,
                currentMonth: new Date().getMonth(),
                currentYear: new Date().getFullYear(),
                selectedGroup: null,
                selectedExercise: null,
                sets: [{ weight: '', reps: '', completed: false }],
                editingWorkout: null,
                currentUser: null,
                bodyWeight: ''
            },

            cachedHistory: {},
            muscleGroupChart: null,
            progressChart: null,
            unsubscribeWorkouts: null,

            async init() {
                try {
                    this.showNotification('–ó–∞–≥—Ä—É–∑–∫–∞...', 'info');

                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–º—ã
                    this.initTheme();

                    // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                    auth.onAuthStateChanged((user) => {
                        this.handleAuthStateChange(user);
                    });

                    // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤–æ–∑–º–æ–∂–Ω—ã–π —Å–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è –∏–∑ URL
                    this.handlePasswordReset();

                    this.renderGroups();
                    this.updateWorkoutDateDisplay();
                    setTimeout(() => this.hideNotification(), 2000);
                } catch (error) {
                    this.showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏', 'error');
                    console.error('Init error:', error);
                }
            },

            // üîÑ –£–ü–†–ê–í–õ–ï–ù–ò–ï –¢–ï–ú–ê–ú–ò
            initTheme() {
                const savedTheme = localStorage.getItem('theme') || 'dark';
                this.setTheme(savedTheme);
            },

            toggleTheme() {
                const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                this.setTheme(newTheme);
                this.showNotification(newTheme === 'light' ? '–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞' : '–¢–µ–º–Ω–∞—è —Ç–µ–º–∞');
            },

            setTheme(theme) {
                document.documentElement.setAttribute('data-theme', theme);
                localStorage.setItem('theme', theme);
                this.updateThemeButton(theme);
            },

            updateThemeButton(theme) {
                const icon = document.getElementById('themeIcon');
                const text = document.getElementById('themeText');

                if (theme === 'light') {
                    icon.textContent = '‚òÄÔ∏è';
                    text.textContent = '–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞';
                } else {
                    icon.textContent = 'üåô';
                    text.textContent = '–¢–µ–º–Ω–∞—è —Ç–µ–º–∞';
                }
            },

            handleAuthStateChange(user) {
                this.state.currentUser = user;

                if (user) {
                    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ—à–µ–ª
                    this.showUserInfo(user);
                    this.loadWorkoutsFromFirebase();
                    this.showNotification(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${user.email}!`);
                } else {
                    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã—à–µ–ª
                    this.showAuthForm();
                    this.cachedHistory = {};
                    this.renderCalendar();
                    this.hideUserData();
                }
            },

            showAuthForm() {
                document.getElementById('authSection').style.display = 'block';
                document.getElementById('userInfo').style.display = 'none';
                document.getElementById('backupSection').style.display = 'none';
                document.getElementById('analyticsBackupSection').style.display = 'none';

                // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –≤—ã—Ö–æ–¥–∞ –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
                document.querySelector('.logout-nav').style.display = 'none';
            },

            showUserInfo(user) {
                document.getElementById('authSection').style.display = 'none';
                document.getElementById('userInfo').style.display = 'block';
                document.getElementById('userEmail').textContent = user.email;
                document.getElementById('backupSection').style.display = 'block';
                document.getElementById('analyticsBackupSection').style.display = 'block';

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –≤—ã—Ö–æ–¥–∞ –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
                document.querySelector('.logout-nav').style.display = 'block';
            },

            hideUserData() {
                document.getElementById('dateWorkouts').style.display = 'none';
                document.getElementById('motivationBlock').style.display = 'block';
            },

            // üîê –§–£–ù–ö–¶–ò–ò –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–Ø –ü–ê–†–û–õ–Ø
            showForgotPassword() {
                document.getElementById('forgotPasswordModal').style.display = 'flex';
                document.getElementById('forgotPasswordEmail').value = document.getElementById('authEmail').value || '';
                document.getElementById('forgotPasswordStatus').textContent = '';
            },

            closeForgotPassword() {
                document.getElementById('forgotPasswordModal').style.display = 'none';
            },

            async sendPasswordReset() {
                const email = document.getElementById('forgotPasswordEmail').value;
                const statusElement = document.getElementById('forgotPasswordStatus');

                if (!email) {
                    statusElement.textContent = '–í–≤–µ–¥–∏—Ç–µ –≤–∞—à email';
                    statusElement.className = 'sync-status error';
                    return;
                }

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å email
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(email)) {
                    statusElement.textContent = '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email';
                    statusElement.className = 'sync-status error';
                    return;
                }

                try {
                    statusElement.textContent = '–û—Ç–ø—Ä–∞–≤–∫–∞ —Å—Å—ã–ª–∫–∏...';
                    statusElement.className = 'sync-status syncing';

                    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º email –¥–ª—è —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è
                    await auth.sendPasswordResetEmail(email);

                    statusElement.textContent = '‚úÖ –°—Å—ã–ª–∫–∞ –¥–ª—è —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ –≤–∞—à email!';
                    statusElement.className = 'sync-status synced';

                    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(() => {
                        this.closeForgotPassword();
                        this.showNotification('–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞—à—É –ø–æ—á—Ç—É –¥–ª—è —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è');
                    }, 3000);

                } catch (error) {
                    console.error('Password reset error:', error);

                    const errorMessage = this.getPasswordResetErrorMessage(error.code);
                    statusElement.textContent = errorMessage;
                    statusElement.className = 'sync-status error';
                }
            },

            getPasswordResetErrorMessage(errorCode) {
                const messages = {
                    'auth/invalid-email': '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email',
                    'auth/user-not-found': '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email –Ω–µ –Ω–∞–π–¥–µ–Ω',
                    'auth/too-many-requests': '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ–ø—ã—Ç–æ–∫. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ',
                    'auth/network-request-failed': '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É'
                };
                return messages[errorCode] || '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ email';
            },

            // üîç –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –±—ã–ª –ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω —Å–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è
            handlePasswordReset() {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º URL –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è
                const urlParams = new URLSearchParams(window.location.search);
                const mode = urlParams.get('mode');
                const oobCode = urlParams.get('oobCode');

                if (mode === 'resetPassword' && oobCode) {
                    this.showNotification('–°—Å—ã–ª–∫–∞ –¥–ª—è —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞—à—É –ø–æ—á—Ç—É.', 'success');

                    // –û—á–∏—â–∞–µ–º URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
                    window.history.replaceState({}, document.title, window.location.pathname);
                }
            },

            // üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞—Ç—ã —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
            updateWorkoutDateDisplay() {
                const dateDisplay = document.getElementById('selectedDateText');
                if (this.state.selectedWorkoutDate) {
                    dateDisplay.textContent = this.state.selectedWorkoutDate;
                } else {
                    dateDisplay.textContent = '–°–µ–≥–æ–¥–Ω—è (' + this.formatDate(new Date()) + ')';
                }
            },

            async signUp() {
                const email = document.getElementById('authEmail').value;
                const password = document.getElementById('authPassword').value;
                const authStatus = document.getElementById('authStatus');

                if (!email || !password) {
                    authStatus.textContent = '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è';
                    authStatus.className = 'sync-status error';
                    return;
                }

                try {
                    authStatus.textContent = '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è...';
                    authStatus.className = 'sync-status syncing';

                    const userCredential = await auth.createUserWithEmailAndPassword(email, password);

                    // üî• –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Firestore
                    await this.saveUserToFirestore(userCredential.user);

                    this.showNotification('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!');
                    authStatus.textContent = '';

                } catch (error) {
                    console.error('Sign up error:', error);
                    authStatus.textContent = this.getAuthErrorMessage(error.code);
                    authStatus.className = 'sync-status error';
                }
            },

            // üî• –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Firestore
            async saveUserToFirestore(user) {
                try {
                    await db.collection('users').doc(user.uid).set({
                        email: user.email,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        lastLogin: firebase.firestore.FieldValue.serverTimestamp()
                    }, { merge: true }); // ‚Üê –î–û–ë–ê–í–¨–¢–ï –≠–¢–£ –°–¢–†–û–ß–ö–£!
                    console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω/–æ–±–Ω–æ–≤–ª–µ–Ω –≤ Firestore');
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Firestore:', error);
                }
            },

            async signIn() {
                const email = document.getElementById('authEmail').value;
                const password = document.getElementById('authPassword').value;
                const authStatus = document.getElementById('authStatus');

                if (!email || !password) {
                    authStatus.textContent = '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è';
                    authStatus.className = 'sync-status error';
                    return;
                }

                try {
                    authStatus.textContent = '–í—Ö–æ–¥...';
                    authStatus.className = 'sync-status syncing';

                    const userCredential = await auth.signInWithEmailAndPassword(email, password);

                    // üî• –û–±–Ω–æ–≤–ª—è–µ–º lastLogin –ø—Ä–∏ –≤—Ö–æ–¥–µ
                    await this.saveUserToFirestore(userCredential.user);

                    this.showNotification('–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω!');
                    authStatus.textContent = '';

                } catch (error) {
                    console.error('Sign in error:', error);
                    authStatus.textContent = this.getAuthErrorMessage(error.code);
                    authStatus.className = 'sync-status error';
                }
            },


            async signOut() {
                try {
                    if (this.unsubscribeWorkouts) {
                        this.unsubscribeWorkouts();
                    }
                    await auth.signOut();
                    this.showNotification('–í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã');
                } catch (error) {
                    console.error('Sign out error:', error);
                    this.showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ', 'error');
                }
            },

            getAuthErrorMessage(errorCode) {
                const messages = {
                    'auth/email-already-in-use': 'Email —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è',
                    'auth/invalid-email': '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email',
                    'auth/weak-password': '–ü–∞—Ä–æ–ª—å —Å–ª–∏—à–∫–æ–º –ø—Ä–æ—Å—Ç–æ–π (–º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤)',
                    'auth/user-not-found': '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω',
                    'auth/wrong-password': '–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å',
                    'auth/too-many-requests': '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ–ø—ã—Ç–æ–∫. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ',
                    'auth/network-request-failed': '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É',
                    'auth/user-disabled': '–ê–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω'
                };
                return messages[errorCode] || '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞';
            },

            // üî• –ó–∞–≥—Ä—É–∑–∫–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –∏–∑ Firebase
            async loadWorkoutsFromFirebase() {
                if (!this.state.currentUser) return;

                try {
                    this.unsubscribeWorkouts = db.collection('workouts')
                        .where('userId', '==', this.state.currentUser.uid)
                        .onSnapshot((snapshot) => {
                            this.cachedHistory = {};

                            snapshot.forEach((doc) => {
                                const workout = doc.data();
                                const date = workout.date;

                                if (!this.cachedHistory[date]) {
                                    this.cachedHistory[date] = [];
                                }
                                this.cachedHistory[date].push({
                                    ...workout,
                                    id: doc.id
                                });
                            });

                            // –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –ø–æ –¥–∞—Ç–µ
                            this.sortWorkoutsByDate();

                            this.renderCalendar();
                            this.updateAnalytics();

                            this.showNotification('–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã', 'success');
                        }, (error) => {
                            console.error('Firestore error:', error);
                        });

                } catch (error) {
                    console.error('Load workouts error:', error);
                    this.showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö', 'error');
                }
            },

            // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –ø–æ –¥–∞—Ç–µ
            sortWorkoutsByDate() {
                const sortedHistory = {};
                const dates = Object.keys(this.cachedHistory).sort((a, b) => {
                    const [dayA, monthA, yearA] = a.split('.').map(Number);
                    const [dayB, monthB, yearB] = b.split('.').map(Number);
                    const dateA = new Date(yearA, monthA - 1, dayA);
                    const dateB = new Date(yearB, monthB - 1, dayB);
                    return dateB - dateA;
                });

                dates.forEach(date => {
                    sortedHistory[date] = this.cachedHistory[date];
                });

                this.cachedHistory = sortedHistory;
            },

            async saveWorkout() {
                if (!this.state.currentUser) {
                    this.showNotification('–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É', 'error');
                    return;
                }

                try {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
                    let isValid = false;

                    if (this.state.selectedGroup === "–ö–∞—Ä–¥–∏–æ") {
                        // –î–ª—è –∫–∞—Ä–¥–∏–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ä–µ–º—è –∏ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å
                        const cardioData = this.state.sets[0];
                        isValid = cardioData.time && cardioData.intensity;
                        if (!isValid) {
                            this.showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Ä–µ–º—è –∏ —É—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏!', 'error');
                            return;
                        }
                    } else {
                        // –î–ª—è —Å–∏–ª–æ–≤—ã—Ö –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤–µ—Å –∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è
                        const completedSets = this.state.sets.filter(set => set.weight && set.reps);
                        isValid = completedSets.length > 0;
                        if (!isValid) {
                            this.showNotification('–î–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –ø–æ–¥—Ö–æ–¥!', 'error');
                            return;
                        }
                    }

                    if (!this.state.selectedExercise || !this.state.selectedGroup) {
                        this.showNotification('–í—ã–±–µ—Ä–∏—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –∏ –≥—Ä—É–ø–ø—É –º—ã—à—Ü!', 'error');
                        return;
                    }

                    const dateString = this.state.selectedWorkoutDate || this.formatDate(new Date());
                    const workout = {
                        exercise: this.state.selectedExercise,
                        muscleGroup: this.state.selectedGroup,
                        sets: this.state.sets,
                        date: dateString,
                        userId: this.state.currentUser.uid,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        bodyWeight: this.state.bodyWeight || null
                    };

                    this.showNotification('–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –æ–±–ª–∞–∫–æ...', 'info');

                    if (this.state.editingWorkout) {
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
                        await db.collection('workouts').doc(this.state.editingWorkout.id).update(workout);
                        this.showNotification(`–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ "${this.state.selectedExercise}" –æ–±–Ω–æ–≤–ª–µ–Ω–∞!`);
                    } else {
                        // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
                        await db.collection('workouts').add(workout);
                        this.showNotification(`–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ "${this.state.selectedExercise}" —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ –æ–±–ª–∞–∫–æ!`);
                    }

                    this.resetWorkoutState();
                    await this.updateAnalytics();

                    setTimeout(() => {
                        this.hideNotification();
                        this.showTab('home');
                    }, 1000);

                } catch (error) {
                    console.error('Save workout error:', error);
                    this.showNotification('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –æ–±–ª–∞–∫–æ', 'error');
                }
            },

            resetWorkoutState() {
                this.state.selectedGroup = null;
                this.state.selectedExercise = null;
                this.state.sets = [{ weight: '', reps: '', completed: false }];
                this.state.editingWorkout = null;
                this.state.bodyWeight = '';

                document.querySelectorAll('.group-button, .exercise-button').forEach(btn => {
                    btn.classList.remove('selected');
                });

                document.getElementById('exercisesSection').style.display = 'none';
                document.getElementById('setsSection').style.display = 'none';
                document.getElementById('bodyWeightSection').style.display = 'none';
            },

            renderCalendar() {
                const calendarGrid = document.getElementById('calendarGrid');
                if (!calendarGrid) return;

                const monthNames = ['–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', '–ú–∞—Ä—Ç', '–ê–ø—Ä–µ–ª—å', '–ú–∞–π', '–ò—é–Ω—å', '–ò—é–ª—å', '–ê–≤–≥—É—Å—Ç', '–°–µ–Ω—Ç—è–±—Ä—å', '–û–∫—Ç—è–±—Ä—å', '–ù–æ—è–±—Ä—å', '–î–µ–∫–∞–±—Ä—å'];
                document.getElementById('currentMonth').textContent = `${monthNames[this.state.currentMonth]} ${this.state.currentYear}`;

                const firstDay = new Date(this.state.currentYear, this.state.currentMonth, 1);
                const startDate = new Date(firstDay);
                const firstDayOfWeek = firstDay.getDay() || 7;
                startDate.setDate(startDate.getDate() - (firstDayOfWeek - 1));

                calendarGrid.innerHTML = '';

                ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–í—Å'].forEach(day => {
                    const dayElement = document.createElement('div');
                    dayElement.className = 'calendar-day';
                    dayElement.textContent = day;
                    calendarGrid.appendChild(dayElement);
                });

                const today = new Date();
                const workoutHistory = this.cachedHistory;

                for (let i = 0; i < 42; i++) {
                    const date = new Date(startDate);
                    date.setDate(startDate.getDate() + i);

                    const dateElement = document.createElement('div');
                    dateElement.className = 'calendar-date';
                    dateElement.dataset.date = this.formatDate(date);

                    const dateString = this.formatDate(date);
                    const hasWorkout = workoutHistory[dateString]?.length > 0;
                    const isToday = date.toDateString() === today.toDateString();
                    const isCurrentMonth = date.getMonth() === this.state.currentMonth;

                    if (!isCurrentMonth) dateElement.classList.add('other-month');
                    if (hasWorkout) dateElement.classList.add('has-workout');
                    if (isToday) dateElement.classList.add('today');

                    dateElement.textContent = date.getDate();
                    dateElement.onclick = () => this.showWorkoutHistory(dateString);
                    calendarGrid.appendChild(dateElement);
                }
            },

            changeMonth(direction) {
                this.state.currentMonth += direction;
                if (this.state.currentMonth < 0) {
                    this.state.currentMonth = 11;
                    this.state.currentYear--;
                } else if (this.state.currentMonth > 11) {
                    this.state.currentMonth = 0;
                    this.state.currentYear++;
                }
                this.renderCalendar();
            },

            showWorkoutHistory(dateString) {
                this.state.selectedWorkoutDate = dateString;
                this.updateWorkoutDateDisplay();

                document.querySelectorAll('.calendar-date').forEach(date => {
                    date.classList.remove('selected');
                    if (date.dataset.date === dateString) {
                        date.classList.add('selected');
                    }
                });

                const workoutHistory = this.cachedHistory;
                const workouts = workoutHistory[dateString];
                const dateWorkoutsElement = document.getElementById('dateWorkouts');
                const motivationBlock = document.getElementById('motivationBlock');

                dateWorkoutsElement.style.display = 'block';
                motivationBlock.style.display = 'none';

                if (workouts?.length > 0) {
                    let historyHTML = `<div class="section-title">–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∑–∞ ${dateString}:</div>
                        <button class="add-button" onclick="app.addWorkoutToDate('${dateString}')" style="margin-bottom: 15px;">
                            + –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –Ω–∞ —ç—Ç—É –¥–∞—Ç—É
                        </button>`;
                    workouts.forEach((workout, index) => {
                        let detailsText = '';
                        if (workout.muscleGroup === "–ö–∞—Ä–¥–∏–æ") {
                            const cardioData = workout.sets[0];
                            detailsText = `–í—Ä–µ–º—è: ${cardioData.time} –º–∏–Ω, –°–ª–æ–∂–Ω–æ—Å—Ç—å: ${cardioData.intensity}/40`;
                        } else {
                            detailsText = `–ü–æ–¥—Ö–æ–¥–æ–≤: ${workout.sets.length}`;
                        }

                        // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–µ—Å–µ —Ç–µ–ª–∞, –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å
                        if (workout.bodyWeight) {
                            detailsText += `, –í–µ—Å —Ç–µ–ª–∞: ${workout.bodyWeight} –∫–≥`;
                        }

                        historyHTML += `
                            <div class="history-item">
                                <div class="history-exercise" onclick="app.viewWorkoutDetails('${dateString}', ${index})">
                                    ${workout.exercise}
                                </div>
                                <div class="history-details">
                                    ${detailsText}
                                </div>
                                <div class="action-buttons">
                                    <button class="edit-button" onclick="app.editWorkout('${dateString}', ${index})">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                                    <button class="delete-button" onclick="app.deleteWorkout('${dateString}', ${index})">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                                </div>
                            </div>
                        `;
                    });
                    dateWorkoutsElement.innerHTML = historyHTML;
                } else {
                    dateWorkoutsElement.innerHTML = `
                        <div class="section-title">–ù–∞ ${dateString} —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –Ω–µ—Ç</div>
                        <button class="add-button" onclick="app.addWorkoutToDate('${dateString}')">
                            + –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –Ω–∞ —ç—Ç—É –¥–∞—Ç—É
                        </button>
                    `;
                }
            },

            viewWorkoutDetails(dateString, workoutIndex) {
                const workoutHistory = this.cachedHistory;
                if (!workoutHistory[dateString]?.[workoutIndex]) {
                    this.showNotification('–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞', 'error');
                    return;
                }

                const workout = workoutHistory[dateString][workoutIndex];
                document.getElementById('modalExerciseName').textContent = workout.exercise;

                let detailsHTML = '<div class="workout-details">';

                // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–µ—Å–µ —Ç–µ–ª–∞, –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å
                if (workout.bodyWeight) {
                    detailsHTML += `
                        <div class="workout-set">
                            <div>–í–µ—Å —Ç–µ–ª–∞</div>
                            <div>${workout.bodyWeight} –∫–≥</div>
                        </div>
                    `;
                }

                if (workout.muscleGroup === "–ö–∞—Ä–¥–∏–æ") {
                    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –∫–∞—Ä–¥–∏–æ
                    const cardioData = workout.sets[0];
                    detailsHTML += `
                        <div class="workout-set">
                            <div>–í—Ä–µ–º—è</div>
                            <div>${cardioData.time} –º–∏–Ω—É—Ç</div>
                        </div>
                        <div class="workout-set">
                            <div>–£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏</div>
                            <div>${cardioData.intensity}/40</div>
                        </div>
                    `;
                } else {
                    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è —Å–∏–ª–æ–≤—ã—Ö
                    workout.sets.forEach((set, index) => {
                        if (set.weight || set.reps) {
                            detailsHTML += `
                                <div class="workout-set">
                                    <div>–ü–æ–¥—Ö–æ–¥ ${index + 1}</div>
                                    <div>${set.weight} –∫–≥ √ó ${set.reps} –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π</div>
                                </div>
                            `;
                        }
                    });
                }
                detailsHTML += '</div>';

                document.getElementById('workoutDetails').innerHTML = detailsHTML;
                document.getElementById('workoutModal').style.display = 'flex';
            },

            closeWorkoutModal() {
                document.getElementById('workoutModal').style.display = 'none';
            },

            addWorkoutToDate(dateString) {
                this.resetWorkoutState();
                this.state.selectedWorkoutDate = dateString;
                this.updateWorkoutDateDisplay();
                this.showTab('workout');
                this.showNotification(`–î–æ–±–∞–≤–ª—è–µ–º —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –Ω–∞ ${dateString}`);
            },

            async editWorkout(dateString, workoutIndex) {
                const workout = this.cachedHistory[dateString][workoutIndex];
                this.showTab('workout');

                this.state.selectedGroup = workout.muscleGroup;
                this.state.selectedExercise = workout.exercise;
                this.state.sets = workout.sets.map(set => ({
                    weight: set.weight || '',
                    reps: set.reps || '',
                    time: set.time || '',
                    intensity: set.intensity || '',
                    completed: set.completed || false
                }));
                this.state.editingWorkout = { date: dateString, index: workoutIndex, id: workout.id };
                this.state.selectedWorkoutDate = dateString;
                this.state.bodyWeight = workout.bodyWeight || '';
                this.updateWorkoutDateDisplay();

                document.getElementById('exercisesSection').style.display = 'block';
                document.getElementById('setsSection').style.display = 'block';
                document.getElementById('bodyWeightSection').style.display = 'block';

                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –≤–µ—Å–∞ —Ç–µ–ª–∞ –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
                document.getElementById('bodyWeightInput').value = this.state.bodyWeight;

                document.querySelectorAll('.group-button').forEach(btn => {
                    btn.classList.remove('selected');
                    if (btn.textContent === this.state.selectedGroup) {
                        btn.classList.add('selected');
                    }
                });

                this.renderExercises();

                setTimeout(() => {
                    document.querySelectorAll('.exercise-button').forEach(btn => {
                        btn.classList.remove('selected');
                        if (btn.textContent === this.state.selectedExercise) {
                            btn.classList.add('selected');
                        }
                    });

                    this.renderSets();
                    document.querySelector('.save-button').textContent = '–û–±–Ω–æ–≤–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É';
                    this.showNotification(`–†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É "${this.state.selectedExercise}"`);

                    document.getElementById('setsSection').scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }, 100);
            },

            async deleteWorkout(dateString, workoutIndex) {
                if (!this.state.currentUser) return;

                if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É?')) return;

                try {
                    const workout = this.cachedHistory[dateString][workoutIndex];
                    if (workout.id) {
                        await db.collection('workouts').doc(workout.id).delete();
                        this.showNotification('–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —É–¥–∞–ª–µ–Ω–∞ –∏–∑ –æ–±–ª–∞–∫–∞!');
                    }
                } catch (error) {
                    console.error('Delete workout error:', error);
                    this.showNotification('–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É', 'error');
                }
            },

            async updateAnalytics() {
                const allWorkouts = this.getAllWorkouts();

                document.getElementById('totalWorkouts').textContent = allWorkouts.length;

                const thisMonth = new Date().getMonth();
                const monthWorkouts = allWorkouts.filter(workout => {
                    const [day, month, year] = workout.date.split('.');
                    return parseInt(month) - 1 === thisMonth;
                });
                document.getElementById('monthWorkouts').textContent = monthWorkouts.length;

                const totalSets = allWorkouts.reduce((sum, workout) => sum + workout.sets.length, 0);
                document.getElementById('totalSets').textContent = totalSets;

                const allWeights = [];
                allWorkouts.forEach(workout => {
                    workout.sets.forEach(set => {
                        if (set.weight && parseFloat(set.weight) > 0) {
                            allWeights.push(parseFloat(set.weight));
                        }
                    });
                });
                const avgWeight = allWeights.length > 0 ? (allWeights.reduce((a, b) => a + b, 0) / allWeights.length).toFixed(1) : '0';
                document.getElementById('avgWeight').textContent = avgWeight;

                this.updateCharts(allWorkouts);
            },

            updateCharts(allWorkouts) {
                if (typeof Chart === 'undefined') {
                    console.warn('Chart.js –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω, –≥—Ä–∞—Ñ–∏–∫–∏ –Ω–µ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω—ã');
                    return;
                }

                const muscleGroups = {};
                allWorkouts.forEach(workout => {
                    muscleGroups[workout.muscleGroup] = (muscleGroups[workout.muscleGroup] || 0) + 1;
                });

                const ctx = document.getElementById('muscleGroupChart');
                if (!ctx) return;

                try {
                    const ctx2d = ctx.getContext('2d');
                    if (this.muscleGroupChart) this.muscleGroupChart.destroy();

                    this.muscleGroupChart = new Chart(ctx2d, {
                        type: 'doughnut',
                        data: {
                            labels: Object.keys(muscleGroups),
                            datasets: [{
                                data: Object.values(muscleGroups),
                                backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40', '#FF6384']
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: { legend: { position: 'bottom' } }
                        }
                    });

                    const progressCtx = document.getElementById('progressChart');
                    if (!progressCtx) return;

                    const progressCtx2d = progressCtx.getContext('2d');
                    if (this.progressChart) this.progressChart.destroy();

                    const lastWorkouts = allWorkouts.slice(-10).reverse();
                    this.progressChart = new Chart(progressCtx2d, {
                        type: 'line',
                        data: {
                            labels: lastWorkouts.map((_, i) => `–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ ${i + 1}`),
                            datasets: [{
                                label: '–°—É–º–º–∞—Ä–Ω—ã–π –≤–µ—Å (–∫–≥)',
                                data: lastWorkouts.map(workout =>
                                    workout.sets.reduce((sum, set) => sum + (parseFloat(set.weight) || 0), 0)
                                ),
                                borderColor: '#007AFF',
                                backgroundColor: 'rgba(0, 122, 255, 0.1)',
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            scales: { y: { beginAtZero: true } }
                        }
                    });
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤:', error);
                }
            },

            getAllWorkouts() {
                const history = this.cachedHistory || {};
                const allWorkouts = [];
                Object.values(history).forEach(workouts => {
                    allWorkouts.push(...workouts);
                });
                return allWorkouts.sort((a, b) => {
                    const dateA = new Date(a.date.split('.').reverse().join('-'));
                    const dateB = new Date(b.date.split('.').reverse().join('-'));
                    return dateA - dateB;
                });
            },

            exportData() {
                try {
                    const data = this.cachedHistory;
                    if (!data || Object.keys(data).length === 0) {
                        this.showNotification('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞', 'error');
                        return;
                    }

                    const prettyData = JSON.stringify(data, null, 2);
                    const blob = new Blob([prettyData], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);

                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `sport-tracker-backup-${this.formatDate(new Date())}.json`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);

                    this.showNotification('–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!');
                } catch (error) {
                    this.showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ –¥–∞–Ω–Ω—ã—Ö', 'error');
                    console.error('Export error:', error);
                }
            },

            importData(event) {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = JSON.parse(e.target.result);

                        if (typeof data !== 'object' || data === null) {
                            throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞');
                        }

                        if (!confirm('–í–Ω–∏–º–∞–Ω–∏–µ! –≠—Ç–æ –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç –≤—Å–µ —Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
                            event.target.value = '';
                            return;
                        }

                        // –î–ª—è –∏–º–ø–æ—Ä—Ç–∞ –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ Firebase
                        this.importDataToFirebase(data);
                        event.target.value = '';
                    } catch (error) {
                        this.showNotification('–û—à–∏–±–∫–∞: –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞', 'error');
                        console.error('Import error:', error);
                    }
                };

                reader.onerror = () => {
                    this.showNotification('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞', 'error');
                };

                reader.readAsText(file);
            },

            async importDataToFirebase(data) {
                if (!this.state.currentUser) {
                    this.showNotification('–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É', 'error');
                    return;
                }

                try {
                    this.showNotification('–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ –æ–±–ª–∞–∫–æ...', 'info');

                    // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ
                    const snapshot = await db.collection('workouts')
                        .where('userId', '==', this.state.currentUser.uid)
                        .get();

                    const batch = db.batch();
                    snapshot.forEach(doc => {
                        batch.delete(doc.ref);
                    });
                    await batch.commit();

                    // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
                    for (const [date, workouts] of Object.entries(data)) {
                        for (const workout of workouts) {
                            await db.collection('workouts').add({
                                ...workout,
                                userId: this.state.currentUser.uid,
                                createdAt: firebase.firestore.FieldValue.serverTimestamp()
                            });
                        }
                    }

                    this.showNotification('–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ –æ–±–ª–∞–∫–æ!');
                } catch (error) {
                    console.error('Import to Firebase error:', error);
                    this.showNotification('–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ –≤ –æ–±–ª–∞–∫–æ', 'error');
                }
            },

            renderGroups() {
                const groupsContainer = document.getElementById('groupsContainer');
                groupsContainer.innerHTML = '';

                Object.keys(this.exercisesDatabase).sort().forEach(group => {
                    const button = document.createElement('button');
                    button.className = 'group-button';
                    button.textContent = group;
                    button.onclick = () => app.selectGroup(group);
                    groupsContainer.appendChild(button);
                });
            },

            selectGroup(group) {
                console.log('–í—ã–±—Ä–∞–Ω–∞ –≥—Ä—É–ø–ø–∞:', group);
                this.state.selectedGroup = group;
                this.state.selectedExercise = null;

                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö
                if (group === "–ö–∞—Ä–¥–∏–æ") {
                    this.state.sets = [{ time: '', intensity: '', completed: false }];
                } else {
                    this.state.sets = [{ weight: '', reps: '', completed: false }];
                }

                document.querySelectorAll('.group-button').forEach(btn => btn.classList.remove('selected'));
                document.querySelectorAll('.group-button').forEach(btn => {
                    if (btn.textContent === group) {
                        btn.classList.add('selected');
                    }
                });

                this.renderExercises();
                document.getElementById('exercisesSection').style.display = 'block';
                document.getElementById('setsSection').style.display = 'none';
                document.getElementById('bodyWeightSection').style.display = 'block';

                setTimeout(() => {
                    document.getElementById('exercisesSection').scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }, 300);
            },

            renderExercises() {
                const exercisesContainer = document.getElementById('exercisesContainer');
                const exercisesTitle = document.getElementById('exercisesTitle');

                exercisesTitle.textContent = `2. –í—ã–±–µ—Ä–∏—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –¥–ª—è ${this.state.selectedGroup}:`;
                exercisesContainer.innerHTML = '';

                this.exercisesDatabase[this.state.selectedGroup].forEach(exercise => {
                    const button = document.createElement('button');
                    button.className = 'exercise-button';
                    button.textContent = exercise;
                    button.onclick = () => app.selectExercise(exercise);
                    exercisesContainer.appendChild(button);
                });
            },

            selectExercise(exercise) {
                console.log('–í—ã–±—Ä–∞–Ω–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ:', exercise);
                this.state.selectedExercise = exercise;

                document.querySelectorAll('.exercise-button').forEach(btn => btn.classList.remove('selected'));
                document.querySelectorAll('.exercise-button').forEach(btn => {
                    if (btn.textContent === exercise) {
                        btn.classList.add('selected');
                    }
                });

                this.renderSets();
                document.getElementById('setsSection').style.display = 'block';

                setTimeout(() => {
                    document.getElementById('setsSection').scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }, 300);
            },

            renderSets() {
                const setsContainer = document.getElementById('setsContainer');
                const selectedExerciseName = document.getElementById('selectedExerciseName');

                selectedExerciseName.textContent = this.state.selectedExercise;
                setsContainer.innerHTML = '';

                if (this.state.selectedGroup === "–ö–∞—Ä–¥–∏–æ") {
                    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –∫–∞—Ä–¥–∏–æ
                    this.state.sets.forEach((set, index) => {
                        const cardioElement = document.createElement('div');
                        cardioElement.className = 'cardio-container';
                        cardioElement.innerHTML = `
                            <div style="min-width: 80px;">–ö–∞—Ä–¥–∏–æ</div>
                            <div class="cardio-inputs">
                                <div style="flex: 1;">
                                    <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">–í—Ä–µ–º—è (–º–∏–Ω)</div>
                                    <input type="number" class="time-input" placeholder="0" value="${set.time}"
                                        onchange="app.updateSet(${index}, 'time', this.value)" min="0" step="1">
                                </div>
                                <div style="flex: 1;">
                                    <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">–°–ª–æ–∂–Ω–æ—Å—Ç—å (1-40)</div>
                                    <input type="number" class="intensity-input" placeholder="0" value="${set.intensity}"
                                        onchange="app.updateSet(${index}, 'intensity', this.value)" min="1" max="40">
                                </div>
                            </div>
                        `;
                        setsContainer.appendChild(cardioElement);
                    });
                } else {
                    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è —Å–∏–ª–æ–≤—ã—Ö
                    this.state.sets.forEach((set, index) => {
                        const setElement = document.createElement('div');
                        setElement.className = 'set-container';
                        setElement.innerHTML = `
                            <div style="min-width: 80px;">–ü–æ–¥—Ö–æ–¥ ${index + 1}</div>
                            <div class="set-inputs">
                                <div style="flex: 1;">
                                    <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">–í–µ—Å (–∫–≥)</div>
                                    <input type="number" class="weight-input" placeholder="0" value="${set.weight}"
                                        onchange="app.updateSet(${index}, 'weight', this.value)" min="0" step="0.5">
                                </div>
                                <div style="flex: 1;">
                                    <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</div>
                                    <input type="number" class="reps-input" placeholder="0" value="${set.reps}"
                                        onchange="app.updateSet(${index}, 'reps', this.value)" min="0">
                                </div>
                            </div>
                            ${this.state.sets.length > 1 ? `
                                <button onclick="app.deleteSet(${index})" style="background: #ff0066; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer;">
                                    üóëÔ∏è
                                </button>
                            ` : ''}
                        `;
                        setsContainer.appendChild(setElement);
                    });
                }
            },

            updateSet(index, field, value) {
                this.state.sets[index][field] = value;
            },

            addSet() {
                if (this.state.selectedGroup === "–ö–∞—Ä–¥–∏–æ") {
                    // –î–ª—è –∫–∞—Ä–¥–∏–æ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –±–ª–æ–∫
                    this.showNotification('–î–ª—è –∫–∞—Ä–¥–∏–æ –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –±–ª–æ–∫ –¥–∞–Ω–Ω—ã—Ö', 'info');
                    return;
                }
                this.state.sets.push({ weight: '', reps: '', completed: false });
                this.renderSets();

                setTimeout(() => {
                    const setsContainer = document.getElementById('setsContainer');
                    const lastSet = setsContainer.lastElementChild;
                    if (lastSet) {
                        lastSet.scrollIntoView({
                            behavior: 'smooth',
                            block: 'center'
                        });
                    }
                }, 100);
            },

            deleteSet(index) {
                if (this.state.sets.length > 1) {
                    this.state.sets.splice(index, 1);
                    this.renderSets();
                }
            },

            showNotification(message, type = 'info') {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.className = `notification ${type === 'error' ? 'error' : ''}`;
                notification.classList.add('show');

                if (type !== 'info') {
                    setTimeout(() => this.hideNotification(), 3000);
                }
            },

            hideNotification() {
                const notification = document.getElementById('notification');
                notification.classList.remove('show');
            },

            async showTab(tabName) {
                document.querySelectorAll('.content').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.nav-button').forEach(btn => btn.classList.remove('active'));

                document.getElementById(tabName).classList.add('active');

                document.querySelectorAll('.nav-button').forEach(btn => {
                    if (btn.textContent.includes(
                        tabName === 'home' ? '–ö–∞–ª–µ–Ω–¥–∞—Ä—å' :
                            tabName === 'workout' ? '–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞' : '–ü—Ä–æ–≥—Ä–µ—Å—Å'
                    )) {
                        btn.classList.add('active');
                    }
                });

                if (tabName === 'analytics') {
                    await this.updateAnalytics();
                } else if (tabName === 'home') {
                    this.renderCalendar();
                    document.getElementById('dateWorkouts').style.display = 'none';
                    document.getElementById('motivationBlock').style.display = 'block';
                } else if (tabName === 'workout') {
                    this.updateWorkoutDateDisplay();
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –≤–µ—Å–∞ —Ç–µ–ª–∞ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
                    this.state.bodyWeight = document.getElementById('bodyWeightInput').value || '';
                }
            },

            formatDate(date) {
                const day = String(date.getDate()).padStart(2, '0');
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const year = date.getFullYear();
                return `${day}.${month}.${year}`;
            }
        };

        document.addEventListener('DOMContentLoaded', () => app.init());

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–µ—Å–∞ —Ç–µ–ª–∞
        document.getElementById('bodyWeightInput').addEventListener('input', function () {
            app.state.bodyWeight = this.value;
        });
    </script>
</body>

</html>